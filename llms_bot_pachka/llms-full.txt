# Pachca API Documentation

This document contains the complete API documentation for Pachca.

# Table of Contents


## Getting started

- [errors](#errors)
- [overview](#overview)
- [requests-and-responses](#requests-and-responses)
- [updates](#updates)
- [webhooks](#webhooks)

## General

- [404](#404)
- [audit-events](#audit-events)
- [index](#index)

## Chats

- [archive](#archive)
- [get](#get)
- [list](#list)
- [new](#new)
- [unarchive](#unarchive)
- [update](#update)

## Messages

- [delete](#delete)
- [delete](#delete)
- [get](#get)
- [link_previews](#link_previews)
- [list](#list)
- [new](#new)
- [new](#new)
- [update](#update)

## Users

- [delete](#delete)
- [get](#get)
- [list](#list)
- [new](#new)
- [update](#update)

## Common

- [export](#export)
- [fields](#fields)
- [files](#files)

## Profile

- [delete](#delete)
- [get](#get)
- [get](#get)
- [put](#put)

## Threads

- [get](#get)
- [new](#new)

## Reactions

- [delete](#delete)
- [list](#list)
- [new](#new)

## Tasks

- [new](#new)

## Members

- [delete](#delete)
- [delete](#delete)
- [leave](#leave)
- [list](#list)
- [new](#new)
- [new](#new)
- [update](#update)

## Group_tags

- [delete](#delete)
- [get](#get)
- [list](#list)
- [new](#new)
- [update](#update)
- [users](#users)

## Read_members

- [list](#list)


---

# Getting started

## errors

<a id="errors"></a>

# Ошибки и лимиты

## Коды

Мы используем обычные коды ответов HTTP для обозначения результата выполнения запроса.

Коды группы 2\*\* указывают на успех. Коды группы 4\*\* указывают на ошибку запроса, который не удался с учетом предоставленной информации (например, обязательный параметр был пропущен, несуществующий идентификатор и др.). Коды группы 5\*\* указывают на ошибки на серверах [Пачки](https://pachca.com) (они редки).

### Коды ответов HTTP

Коды ответов HTTP

| 200 - ОК | Запрос отработал как положено, без ошибок |
| --- | --- |
| 201 - Created | Запрос отработал успешно, сущность создана |
| 301 - Moved Permanently | Запрошенный ресурс был на постоянной основе перемещён в новое месторасположение (такой ответ вы можете получить если выполните запрос по протоколу HTTP, а не по HTTPS) |
| 400 - Bad Request | Неприемлемый запрос (часто из-за отсутствия обязательного параметра) |
| 401 - Unauthorized | Предоставлен недействительный токен доступа |
| 402 - Payment Required | Параметры действительны, но запрос не выполнен |
| 403 - Forbidden | Предоставленный токен доступа не имеет разрешений на выполнение запроса |
| 404 - Not Found | Запрашиваемый ресурс не существует |
| 409 - Conflict | Запрос конфликтует с другим запросом (возможно, из-за использования того же идемпотентного ключа). |
| 422 - Unprocessable Entity | С запросом все хорошо, но правила сервиса не позволяют его обработать (например, при попытке создания контакта с уже существующим номером телефона в базе) |
| 429 - Too Many Requests | Слишком много запросов слишком быстро попадают в API. |
| 500, 502, 503, 504 - Server Errors | Что-то пошло не так на сервере Пачки (это редкость) |

## Пояснения ошибки

Вместе с кодом 400 вы получите в теле ответа массив `errors` .

В этом массиве вы найдете список ошибок, которые помогут вам разобраться и повторить запрос с уже успешным исходом. Каждая ошибка представлена объектом с набором параметров.

### Пояснения ошибки

Пояснения ошибки

| key | string | Ключ параметра, в котором произошла ошибка |
| --- | --- | --- |
| value | string | Значение ключа, которое вызвало ошибку |
| message | string | Ошибка текстом, который вы можете вывести пользователю |
| code | string | Внутренний код ошибки (коды ошибок представлены в описании каждого метода) |
| payload | object | Объект, который предоставляет любую дополнительную информацию (возможные дополнения представлены в описании каждого метода) |

## Лимиты

Мы следим за стабильностью API, поэтому есть лимиты на запросы (rate limiting). Они гибкие, зависят от нагрузки, но мы сделали их комфортными — должно хватить для любых ваших задач.

Входящие вебхуки

Лимит

~2 запроса

Период

1 секунда

Как работает

Лимит привязан к идентификатору вебхука в пути  
Например, для /webhooks/user123 считаем по user123

Если за секунду отправите больше 2 запросов на один идентификатор, лишние получат 429 Too Many Requests. В заголовке Retry-After мы укажем, через сколько секунд можно попробовать снова.

API

Лимит

~100 запросов

Период

1 секунда

Как работает

Считаем по токену авторизации (заголовок HTTP\_AUTHORIZATION)  
Один токен — один лимит

Если за секунду будет больше 100 запросов с одним токеном, API вернёт 429 Too Many Requests. Проверьте заголовок Retry-After — там будет точное время для следующей попытки.

\- Лимиты гибкие: они ориентировочные и могут меняться, чтобы всё работало гладко;  
\- Должно хватать на всё: мы настроили их так, чтобы вам было комфортно в любых сценариях;  
\- Если упёрлись в лимит: при ошибке `429` смотрите заголовок `Retry-After` — он подскажет, через сколько секунд повторить запрос (или используйте экспоненциальный `backoff` , если хотите перестраховаться).

---

## overview

<a id="overview"></a>

# Обзор

## Создавайте уникальные решения на одной платформе

[

a Боты Доступ к автоматизациям

](#title-bots)[

b Webhook Входящие и Исходящие

](#title-incweb)[

c API Создание чатов, сообщений и тд

](#title-api)[

d Администрирование Управление сотрудниками

](#title-admin)[

e Аналитика Экспорт сообщений

](#title-analytics)[

f Unfurl Разворачивание ссылок

](#title-unfurl)

Администрирование состава участников пространства и их профилей через API · Интеграции на основе API для создания чатов и отправки сообщений в указанные чаты · Входящие вебхуки для упрощенной отправки сообщений без API · Получение информации в реальном времени при помощи исходящих вебхуков · [и многое другое](https://www.pachca.com/blog#integration)

**Полезные форматы для работы с AI:**  
[llms.txt](http://crm.pachca.com/dev/llms.txt) — краткая версия всей документации в markdown  
[llms-full.txt](http://crm.pachca.com/dev/llms-full.txt) — полный markdown-файл с оглавлением  
Также вы можете получить markdown-версию любой страницы, добавив .md к её адресу или используя кнопку «Скопировать как .md» в правом верхнем углу.

## Боты

Боты в Пачке являются основным способом создания автоматизаций. С помощью ботов вы можете использовать входящие и исходящие вебхуки, а также использовать API.

О том, как создать бота, добавить его в чаты и получить access\_token, вы можете прочитать в статье  
[https://www.pachca.com/articles/webhook](https://www.pachca.com/articles/webhook)

## Входящий Webhook

Входящий вебхук позволяет вам от имени бота отправлять сообщения в чаты, в которых бот состоит. При этом вам не требуется использовать API, а гибкость работы с принимаемыми данными вы можете настроить с помощью шаблонизаторов Liquid и Mustache. Это удобно, если вы используете бота только для получения каких-то простых внешних событий и сами указываете, в какие чаты бот добавлен (возможно, всего в один).

Входящий вебхук не дает возможности отправить личное сообщение или в указанный чат. Сообщение будет отправлено во все групповые чаты, где состоит бот. Чтобы отправить личное сообщение или указать конкретный чат - воспользуйтесь API методом [Новое сообщение](/messages/new).

Подробнее о работе с шаблонизаторами вы можете прочитать в статье  
[https://www.pachca.com/articles/kak-pravilno-zapolnit-shablon-webhook](https://www.pachca.com/articles/kak-pravilno-zapolnit-shablon-webhook)

## Исходящий Webhook

Исходящий вебхук позволяет вам получать уведомления о различных событиях на указанный вами URL.

Доступны следующие типы событий:  
\- Новые сообщения  
\- Редактирование и удаление сообщений  
\- Добавление и удаление реакций  
\- Нажатие кнопок  
\- Изменение состава участников чатов  
\- Изменение состава участников пространства

Вы можете как получать события о всех новых сообщениях, так и только тех, которые начинаются с указанных команд.

Подробнее об исходящих вебхуках вы можете прочитать по [ссылке](/getting-started/webhooks)

## API

Каждый созданный бот имеет свой уникальный токен для работы с API. Если вам нужно создавать чаты, управлять составом участников чатов, отправлять сообщения в указанные чаты и создавать интерактивное взаимодействие пользователя с ботом - вам необходимо использовать API.

Всю документацию по доступным методам и правилам работы с API вы можете найти в меню слева

## Администрирование

Вы можете автоматизировать управление составом участников пространства и наполнением их профилей. Каждый сотрудник в компании с ролью «Администратор» и «Владелец» имеет свой уникальный токен, который позволяет ему использовать уникальные методы API, недоступные ботам.

Список уникальных методов API:  
\- [Новый сотрудник](/users/new)  
\- [Редактирование сотрудника](/users/update)  
\- [Удаление сотрудника](/users/delete)  
\- [Новый тег](/group_tags/new)  
\- [Редактирование тега](/group_tags/update)  
\- [Удаление тега](/group_tags/delete)  
\- [Удаление сообщения](/messages/delete)

Получить access\_token для работы с API вы можете в интерфейсе продукта, в разделе «Автоматизации» → «API» (данный раздел доступен только пользователям с ролью «Администратор» и «Владелец»)

## Аналитика

На тарифе «Корпорация» владелец пространства может запросить экспорт через API, тем самым автоматизировать выгрузку сообщений и построение аналитики (или регулярное создание личных бекапов сообщений пространства).

Дополнительно, на любом тарифе можно получить сообщения доступных чатов через метод [Список сообщений чата](/messages/list).

Документация по работе с экспортом сообщений доступа по [ссылке](/common/export)

## Unfurl

Дополнительным исходящим вебхуком является возможность отслеживать отправленные пользователями ссылки и дополнять их своими данными, полученными из других систем.

Подробнее о разворачивании ссылок вы можете прочитать в статье  
[https://www.pachca.com/articles/unfurling-ssylok-v-pachce](https://www.pachca.com/articles/unfurling-ssylok-v-pachce)

Документация по работе с методом разворачивания ссылок доступа по [ссылке](/messages/link_previews)

---

## requests-and-responses

<a id="requests-and-responses"></a>

# Запросы и ответы

## Доступ

Для работы с методами API вам необходимо иметь действующий `access_token` .

`access_token` не имеет времени жизни. Если вы используете `access_token` «Администратора» или «Владельца» пространства, то в разделе «Автоматизации» → «API» вы можете воспользоваться функцией сброса токена. В таком случае вы увидите новый `Access token` , а предыдущий станет недействительным.

## Структура запроса метода API

При выполнении запроса `access_token` необходимо поместить в заголовки (ключ Authorization с указанием типа Bearer), а в теле запроса указать все необходимые параметры метода. При этом не забудьте, что сервер ожидает перечисление параметров в формате `JSON` , кодировке `UTF-8` , на базовый адрес `https://api.pachca.com/api/shared/v1` (с указанием метода) и по протоколу `HTTPS` .

### Пример запроса* (новый сотрудник)

Пример запроса\* (новый сотрудник)

post /api/shared/v1/users HTTP/1.1

Authorization

:

Bearer Pm7gdycNeHV\_F1y4\_tjWWIutC0Aq0gwl9wRnX-KBuHw

Content-Type

:

application/json; charset=utf-8

Host

:

api.pachca.com

Connection

:

close

User-Agent

:

Paw/3.1.10 (Macintosh; OS X/10.15.3) GCDHTTPRequest

Content-Length

:

219

{"user":{"first\_name":"Олег","last\_name":"Петров","email":"olegp@example.com","department":"Продукт","list\_tags":\["Product","Design"\],"custom\_properties":\[{"id":1678,"value":"Санкт-Петербург"}\]},"skip\_email\_notify":true}

## Обработка ответа метода API

Мы используем обычные коды ответов HTTP для обозначения результата выполнения запроса.

Ответ от сервера приходит в формате `JSON` и кодировке `UTF-8` .

При успешном ответе возвращаемый сервером результат будет представлен в теле ответа массивом `data` .

При ошибке выполнения запроса вы можете получить в теле ответа массив `errors` (подробнее об [ошибках](/getting-started/errors) выполнения запросов вы можете прочитать в следующем разделе документации).

### Пример ответа на запрос (новый сотрудник)

Пример ответа на запрос (новый сотрудник)

HTTP/1.1 201 Created

Server

:

nginx/1.14.2

Date

:

Wed, 22 Apr 2020 12:32:29 GMT

Content-Type

:

application/json; charset=utf-8

Transfer-Encoding

:

chunked

Connection

:

close

ETag

:

W/"4d63aae1430a3bbd35e95e3db6b364df"

Cache-Control

:

max-age=0, private, must-revalidate

X-Request-Id

:

12f8a05c-c5cf-4a79-8d2f-f82cc477c410

X-Runtime

:

0.117503

Vary

:

Origin

X-Rack-CORS

:

miss; no-origin

{"data":{"id":12,"first\_name":"Олег","last\_name":"Петров","nickname":"","email":"olegp@example.com","phone\_number":"","department":"Продукт","role":"admin","suspended":false,"invite\_status":"confirmed","list\_tags":\["Product","Design"\],"custom\_properties":\[{"id":1678,"name":"Город","data\_type":"string","value":"Санкт-Петербург"}\]}}

---

## updates

<a id="updates"></a>

# Последние обновления

## Новые методы в API и дополнения в уже существующих

### New 02.06.2025Список участников чата

New 02.06.2025

**Список участников чата**

Был добавлен новый метод:  
\- [Список участников чата](/members/users/list)  
  
С помощью этого метода можно запросить список участников чата с фильтрацией по ролям в чате.

### New 02.06.2025Название реакции

New 02.06.2025

**Название реакции**

В исходящий вебхук о добавлении и удалении реакций было добавлено новое поле:  
\- name  
  
С помощью этого поля вы сможете получить точное название реакции.  
Прочитать актульную документацию по исходящим вебхукам вы можете на странице [Исходящий Webhook](/getting-started/webhooks).

### 21.05.2025API Аудит Событий

21.05.2025

**API Аудит Событий**

Был добавлен новый раздел документации, посвященный API Аудит Событий. Этот раздел содержит подробную информацию о методах, которые позволяют отслеживать и получать данные о важных событиях, происходящих в вашем пространстве.  
  
Новый раздел включает следующие методы:  
\- [Список событий аудита](/audit-events)  
  
Эти методы предоставляют возможность контролировать активность пользователей и системные изменения, что критически важно для обеспечения безопасности и соответствия требованиям.

### 27.04.2025Markdown версия документации для работы с AI-ассистентами

27.04.2025

**Markdown версия документации для работы с AI-ассистентами**

Мы добавили новые возможности для работы с документацией API, которые значительно упростят взаимодействие с AI-ассистентами:  
  
\- **Markdown-версия документации** — теперь вы можете получить markdown-версию любой страницы документации, добавив .md к URL или нажав на кнопку «Скопировать как .md» в правом верхнем углу страницы.  
  
\- **Полная документация в удобных форматах** — на главной странице документации вы найдете прямые ссылки для скачивания полной документации:  
  • [llms.txt](http://crm.pachca.com/dev/llms.txt) — краткая версия в формате markdown с сохранением ссылок  
  • [llms-full.txt](http://crm.pachca.com/dev/llms-full.txt) — полная версия в едином файле с оглавлением  
  
Эти улучшения значительно упрощают работу с AI-моделями. Теперь вы можете легко предоставить AI-ассистенту всю необходимую документацию в компактном формате, что повышает эффективность взаимодействия и точность выполнения запросов, связанных с API Пачки.  
  
Markdown-формат обеспечивает лучшую структуру и читаемость для AI-моделей, позволяя им более точно интерпретировать методы API и выполнять нужные вам задачи.

### 07.04.2025Сортировка сообщений

07.04.2025

**Сортировка сообщений**

В запрос списка сообщений было добавлено новое поле:  
\- sort\[{field}\]  
  
С помощью этого поля вы можете изменить порядок получаемых сообщений. На данный момент доступа сортировка по идентификатору сообщения (по возрастанию или по убыванию значения).  
  
Был обновлен следующий метод:  
\- [Список сообщений чата](/messages/list)

### 21.03.2025Экспорт сообщений

21.03.2025

**Экспорт сообщений**

Был добавлен новый метод:  
\- [Экспорт сообщений](/common/export)  
  
С помощью этого метода Владелец пространства на тарифе «Корпорация» может запросить экспорт сообщений пространства в формате JSON файлов, упакованных в zip архив.

### 18.03.2025Информация о профиле

18.03.2025

**Информация о профиле**

Был добавлен новый метод:  
\- [Информация о профиле](/profile/get)  
  
С помощью этого метода вы можете получить всю информацию о пользователе, access\_token которого используется.

### 17.03.2025Сортировка чатов по времени создания последнего сообщения

17.03.2025

**Сортировка чатов по времени создания последнего сообщения**

В поле sort\[{field}\] была добавлена поддержка нового значения:  
\- last\_message\_at  
  
Это значение позволяет запрашивать список чатов, отсортированный по дате и времени создания последнего сообщения. При этом также поддерживаются сортировки по возврастанию убыванию.  
  
Был обновлен следующий метод:  
\- [Список чатов](/chats/list)

### 06.03.2025Специальная аватарка и имя отправителя для каждого сообщения

06.03.2025

**Специальная аватарка и имя отправителя для каждого сообщения**

В объект message были добавлены новые поля:  
\- display\_avatar\_url  
\- display\_name  
  
Эти поля позволяют указать специальную аватарку и имя отправителя для сообщения. Доступно только при отправке и редактировании сообщения с использованием access\_token бота.  
  
Были обновлены следующие методы:  
\- [Новое сообщение](/messages/new)  
\- [Информация о сообщении](/messages/get)  
\- [Список сообщений чата](/messages/list)  
\- [Редактирование сообщения](/messages/update)

### 27.02.2025Ширина и высота изображения

27.02.2025

**Ширина и высота изображения**

В объекты файлов поля message.files были добавлены новые поля:  
\- width  
\- height  
  
Эти поля позволяют указать ширину и высоту прикладываемого к сообщению изображения. Эти параметры используются для корректного отображения предпросмотра изображений в чате.  
  
Были обновлены следующие методы:  
\- [Новое сообщение](/messages/new)  
\- [Информация о сообщении](/messages/get)  
\- [Список сообщений чата](/messages/list)  
\- [Редактирование сообщения](/messages/update)

### 31.01.2025Ссылка на сообщение

31.01.2025

**Ссылка на сообщение**

В объект message было добавлено новое поле:  
\- url  
  
Это поле позволяет получить прямую ссылку на сообщение.  
  
Были обновлены следующие методы:  
\- [Новое сообщение](/messages/new)  
\- [Информация о сообщении](/messages/get)  
\- [Список сообщений чата](/messages/list)  
\- [Редактирование сообщения](/messages/update)

### 20.01.2025Дата последней активности пользователя

20.01.2025

**Дата последней активности пользователя**

В объект user было добавлено новое поле:  
\- last\_activity\_at  
  
Это поле позволяет получить дату последней активности пользователя.  
  
Были обновлены следующие методы:  
\- [Новый сотрудник](/users/new)  
\- [Информация о сотруднике](/users/get)  
\- [Список сотрудников](/users/list)  
\- [Редактирование сотрудника](/users/update)  
\- [Список сотрудников тега](/group_tags/users)

---

## webhooks

<a id="webhooks"></a>

# Исходящий Webhook

Исходящие вебхуки позволяют вам получать информацию о событиях в вашем пространстве в реальном времени. Это могут быть новые сообщения, реакции, чаты, участники и тд.

Вебхук представляет собой `JSON` объект, отправляемый в момент наступления события на указанный в настройках бота `URL` , содержащий небольшое количество информации, которой достаточно для написания автоматизаций. Если требуется получить больше информации об объектах, указанных в `JSON` \- вы можете воспользоваться `API` и получить полную информацию.

Доступны следующие типы событий:  
\- [Новые сообщения](/getting-started/webhooks/#new-message)  
\- [Редактирование и удаление сообщений](/getting-started/webhooks/#edit-message)  
\- [Добавление и удаление реакций](/getting-started/webhooks/#reaction)  
\- [Нажатие кнопок](/getting-started/webhooks/#button)  
\- [Изменение состава участников чатов](/getting-started/webhooks/#chat-member)  
\- [Изменение состава участников пространства](/getting-started/webhooks/#company-member)

Каждый исходящий вебхук защищён с помощью подписи, основанной на хешировании содержимого. Подробнее об этом, а также о других методах проверки подлинности исходящего вебхука, вы можете прочитать в блоке [Безопасность](/getting-started/webhooks/#securing).

## Как получать Webhook

Все настройки исходящих вебхуков находятся в чат-ботах. Создавая нового бота, вы получаете возможность указать `Webhook URL` и выбрать те события, которые вы хотите получать.

Большинство типов событий потребуют добавления бота в чаты. Именно по этим чатам и по отправленным ботом сообщениям вы будете получать события. Есть глобальные события (например, Изменение состава участников пространства), которые не требуют добавления бота в чат.

О том, как создать бота и добавить его в чаты, вы можете прочитать в статье  
[https://www.pachca.com/articles/webhook](https://www.pachca.com/articles/webhook)

## Новые сообщения

Данный вебхук отправляется при появлении нового сообщения в чате, где участвует бот.

Вы можете получать как все новые сообщения в чате, так и только те, которые начинаются с указанных команд. Это будет полезно, если вы не хотите получать поток событий, а вам нужно только по требованию пользователя вызвать какой-то сценарий.

### Структура исходящего вебхука о сообщении

Структура исходящего вебхука о сообщении

| type | string | Тип объекта (для сообщений всегда message) |
| --- | --- | --- |
| id | integer | Идентификатор сообщения |
| event | string | Тип события: new (новое сообщение), update (редактирование сообщения) или delete (удаление сообщения) |
| entity_type | string | Тип сущности, к которой относится сообщение: discussion (беседа или канал), thread (тред) или user (пользователь, если это личное сообщение) |
| entity_id | integer | Идентификатор сущности, к которой относится сообщение |
| content | string | Текст сообщения |
| user_id | integer | Идентификатор отправителя сообщения |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| url | string | Прямая ссылка на сообщение |
| chat_id | integer | Идентификатор чата, в котором находится сообщение |
| parent_message_id | integer или null | Идентификатор сообщения, к которому написан ответ. Возвращается как null, если сообщение не является ответом. |
| thread | object или null | Объект с параметрами треда. Возвращается как null, если это сообщение не относится к треду. |
| message_id | integer | Идентификатор сообщения, к которому был создан тред |
| message_chat_id | integer | Идентификатор чата сообщения, к которому был создан тред |
| webhook_timestamp | string | Дата и время отправки вебхука (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |

## Редактирование и удаление сообщений

Данный вебхук отправляется при редактировании или удалении сообщения в чате, где участвует бот.

Структура исходящего вебхука такая же, как и при новом сообщении (смотреть на значение поля event)

## Добавление и удаление реакций

Данный вебхук отправляется при добавлении или удалении реакции на сообщение в чате, где участвует бот.

### Структура исходящего вебхука о реакции

Структура исходящего вебхука о реакции

| type | string | Тип объекта (для реакций всегда reaction) |
| --- | --- | --- |
| event | string | Тип события: new (добавление реакции) или delete (удаление реакции) |
| message_id | integer | Идентификатор сообщения, к которому относится реакция |
| code | string | Emoji символ реакции |
| name | string | Название реакции |
| user_id | integer | Идентификатор пользователя, который добавил или удалил реакцию |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| webhook_timestamp | string | Дата и время отправки вебхука (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |

## Нажатие кнопок

Данный вебхук отправляется при нажатии `Data-кнопки` в сообщении от бота. После получения этого вебхука вы можете воспользоваться методом [Редактирование сообщения](/messages/update) и изменить/удалить кнопки у сообщения или отправить [Новое сообщение](/messages/new) как реакцию пользователю.

Подробнее о работе с кнопками в ботах вы можете прочитать в статье  
[https://www.pachca.com/articles/knopki-v-chat-botah](https://www.pachca.com/articles/knopki-v-chat-botah)

### Структура исходящего вебхука о нажатии кнопки

Структура исходящего вебхука о нажатии кнопки

| type | string | Тип объекта (для кнопки всегда button) |
| --- | --- | --- |
| message_id | integer | Идентификатор сообщения, к которому относится кнопка |
| data | string | Данные нажатой кнопки |
| user_id | integer | Идентификатор пользователя, который нажал кнопку |
| webhook_timestamp | string | Дата и время отправки вебхука (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |

## Изменение состава участников чатов

Данный вебхук отправляется при изменении состава участников чатов, где состоит бот, и в тредах этих чатов.

### Структура исходящего вебхука об участниках чата

Структура исходящего вебхука об участниках чата

| type | string | Тип объекта (для участника чата всегда chat_member) |
| --- | --- | --- |
| event | string | Тип события: add (добавление) или remove (исключение) |
| chat_id | integer | Идентификатор чата, в котором изменился состав участников |
| thread_id | integer или null | Идентификатор треда. Возвращается как null, если чат не относится к треду. |
| user_ids | array of integers | Массив идентификаторов пользователей, с которыми произошло событие |
| created_at | string | Дата и время события (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| webhook_timestamp | string | Дата и время отправки вебхука (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |

## Изменение состава участников пространства

Данный вебхук отправляется при изменении состава участников пространства, включая изменение состояния участников (смотреть на значение поля event).

### Структура исходящего вебхука об участниках пространства

Структура исходящего вебхука об участниках пространства

| type | string | Тип объекта (для участника пространства всегда company_member) |
| --- | --- | --- |
| event | string | Тип события: invite (добавление в пространство), confirm (принятие приглашения), suspend (деактивация доступа), activate (активация доступа) или delete (удаление) |
| user_ids | array of integers | Массив идентификаторов пользователей, с которыми произошло событие |
| created_at | string | Дата и время события (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| webhook_timestamp | string | Дата и время отправки вебхука (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |

## Безопасность

Каждый исходящий вебхук защищён с помощью подписи, основанной на хешировании содержимого. Подпись `HMAC` с использованием алгоритма `SHA256` вычисляется из тела запроса и передаётся в заголовке `Pachca-Signature` .

В теле вебхука также содержится поле `webhook_timestamp` — метка времени в формате UNIX, указывающая момент отправки вебхука. Рекомендуется проверять, что это значение находится в пределах одной минуты от времени получения запроса, чтобы предотвратить атаки повторной отправки (replay attacks).

### Пример исходящего вебхука (новое сообщение)

Пример исходящего вебхука (новое сообщение)

post https://yourweb.site/read HTTP/1.1

host

:

yourweb.site

content-Type

:

application/json

pachca-signature

:

a805d3470c263f4628cafc4ed66235d8fe2229891d1fcf4e400331adff5d8e5a

user-agent

:

Faraday v2.12.2

content-length

:

358

{"event":"new","type":"message","webhook\_timestamp":1744618734,"chat\_id":918264,"content":"Клиент просит поправить шапку, подробности в документе","user\_id":134412,"id":56431,"created\_at":"2025-04-14T08:18:54.000Z","parent\_message\_id":null,"entity\_type":"discussion","entity\_id":918264,"thread":null,"url":"https://app.pachca.com/chats/124511?message=56431"}

Для проверки подписи необходимо вычислить её самостоятельно, используя секрет вебхука `Signing secret` , который доступен в настройках бота во вкладке «Исходящий webhook». Рекомендуется использовать сырой (raw) контент тела запроса для вычисления хеша, так как при JSON-парсинге содержимое может быть изменено.

### Вычисление и сравнение подписи

Вычисление и сравнение подписи

```code-snippet__inner
//WEBHOOK_SECRET - значение поля Signing secret во вкладке «Исходящий webhook» в настройках бота

const signature = crypto.createHmac("sha256", WEBHOOK_SECRET).update(rawBody).digest("hex");
if (signature !== request.headers['pachca-signature']) {
  throw "Invalid signature"
}
```

Кроме проверки подписи, также рекомендуется валидировать IP-адреса отправителя.  
IP-адрес Пачки: `37.200.70.177`

---

# General

## 404

<a id="404"></a>

# 404 :-(

---

## audit-events

<a id="audit-events"></a>

# Пачка Audit Events API Доступно только на тарифе «Корпорация»

Audit events API Пачки предоставляет командам безопасности доступ к логам о критически важных событиях в мессенджере. Это позволяет обеспечивать надежный мониторинг и соответствовать требованиям информационной безопасности и регуляторов.

## Базовый URL

`https://api.pachca.com/api/shared/v1/audit_events`

## Аутентификация

Все запросы к API журнала аудита требуют аутентификации с использованием OAuth-токена в заголовке Authorization:

`Authorization: Bearer ВАШ_ТОКЕН`

**Примечание:** API доступно только по токену владельца компании.

## Метод

### получить логи событий на основе указанных фильтров

get /audit-events получить логи событий на основе указанных фильтров

Параметры запроса Формат ответа Статус-коды

#### Запрос

| Запрос |
| --- |
| start_time | ISO 8601 | Начальная метка времени (включительно), например,2025-05-01T09:11:00Z |
| end_time | ISO 8601 | Конечная метка времени (исключительно), например,2025-05-02T09:11:00Z |
| event_key | Строка | Фильтр по конкретному типу события, например,user_login |
| actor_id | Число | ID пользователя, выполнившего действие |
| actor_type | Строка | Тип актора, например,User |
| entity_id | Число | ID затронутой сущности |
| entity_type | Строка | Тип сущности, например,Chat |
| limit | Число | Количество записей для возврата (по умолчанию:50, максимум:50) |
| cursor | Строка | Курсор для пагинации из meta.paginate.next_page |

```code-snippet__inner
{
  "data": [
    {
      "id": "a1b2c3d4-5e6f-7g8h-9i10-j11k12l13m14",
      "created_at": "2025-05-15T14:30:00.000Z",
      "event_key": "user_chat_join",
      "entity_id": "12345678",
      "entity_type": "Chat",
      "actor_id": "98765",
      "actor_type": "User",
      "details": {
        "inviter_id": "45678"
      },
      "ip_address": "192.168.1.100",
      "user_agent": "Pachca/3.60.0 (co.staply.pachca; build:15; iOS 18.5.0) Alamofire/5.0.0"
    }
  ],
  "meta": {
    "paginate": {
      "next_page": "eyJfa2QiOiJuIiwiY3JlYXRlZF9hdCI6IjIwMjUtMDUtMTUgMTQ6MzA6MDAuMDAwWiJ9"
    }
  }
}
```

#### Ответ

| Ответ |
| --- |
| 200 | Успех |
| 400 | Неверные параметры запроса |
| 401 | Несанкционированный доступ |
| 403 | Недостаточно прав |
| 429 | Превышен лимит запросов |

## Реализованные типы событий

В текущей версии API реализованы следующие типы событий:

### События аутентификации

События аутентификации

| user_login | Пользователь успешно вошел в систему |
| --- | --- |

### События управления пользователями

События управления пользователями

| user_created | Создана новая учетная запись пользователя |
| --- | --- |
| user_deleted | Учетная запись пользователя удалена |
| user_role_changed | Роль пользователя была изменена |

### События управления тегами

События управления тегами

| tag_created | Создан новый тег |
| --- | --- |
| tag_deleted | Тег удален |
| user_added_to_tag | Пользователь добавлен в тег |
| user_removed_from_tag | Пользователь удален из тега |

### События управления чатами

События управления чатами

| chat_created | Создан новый чат |
| --- | --- |
| chat_renamed | Чат переименован |
| chat_permission_changed | Изменены права доступа к чату |
| user_chat_join | Пользователь присоединился к чату |
| user_chat_leave | Пользователь покинул чат |
| tag_added_to_chat | Тег добавлен в чат |
| tag_removed_from_chat | Тег удален из чата |

### События управления сообщениями

События управления сообщениями

| message_deleted | Сообщение удалено |
| --- | --- |

### События безопасности

События безопасности

| audit_events_accessed | Доступ к журналам аудита получен |
| --- | --- |

## Примеры использования

### Получение всех событий входа в систему за определенный период

Получение всех событий входа в систему за определенный период

```code-snippet__inner
curl --location 'https://api.pachca.com/api/shared/v1/audit_events' \
--header 'Authorization: ••••••' \
--data-urlencode 'start_time=2025-05-01T00:00:00Z' \
--data-urlencode 'end_time=2025-05-02T00:00:00Z' \
--data-urlencode 'event_key=user_login' \
--data-urlencode 'limit=50'
```

### Получение всех событий, связанных с конкретным пользователем

Получение всех событий, связанных с конкретным пользователем

```code-snippet__inner
curl --location 'https://api.pachca.com/api/shared/v1/audit_events' \
--header 'Authorization: ••••••' \
--data-urlencode 'actor_id=133321' \
--data-urlencode 'actor_type=User' \
--data-urlencode 'start_time=2025-05-01T00:00:00Z' \
--data-urlencode 'end_time=2025-05-02T00:00:00Z'
```

### Получение всех изменений прав доступа к чатам

Получение всех изменений прав доступа к чатам

```code-snippet__inner
curl --location 'https://api.pachca.com/api/shared/v1/audit_events' \
--header 'Authorization: ••••••' \
--data-urlencode 'event_key=chat_permission_changed' \
--data-urlencode 'start_time=2025-05-01T00:00:00Z' \
--data-urlencode 'end_time=2025-05-08T00:00:00Z'
```

## Хранение данных

Журналы аудита хранятся в течение 90 дней для баланса между требованиями соответствия и эффективностью хранения. Все журналы неизменяемы и хранятся в системе только для чтения, чтобы обеспечить целостность данных.

## Типичные сценарии использования

\- Расследовать подозрительные попытки входа в систему  
\- Отслеживать изменения прав доступа  
\- Отслеживать действия по удалению сообщений  
\- Расследовать изменения ролей пользователей  
\- Отслеживать изменения в составе участников чатов  
\- Составлять отчеты о соответствии требованиям и во время аудита

## Ограничения

\- Текущая версия API поддерживает только типы событий, указанные в документации  
\- Данные собираются только с 12 мая 2025 года  
\- За один запрос можно запросить только один тип события  
\- Список событий и фильтры планируется развивать в следующих версиях.

---

## index

<a id="index"></a>

# Обзор

## Создавайте уникальные решения на одной платформе

[

a Боты Доступ к автоматизациям

](#title-bots)[

b Webhook Входящие и Исходящие

](#title-incweb)[

c API Создание чатов, сообщений и тд

](#title-api)[

d Администрирование Управление сотрудниками

](#title-admin)[

e Аналитика Экспорт сообщений

](#title-analytics)[

f Unfurl Разворачивание ссылок

](#title-unfurl)

Администрирование состава участников пространства и их профилей через API · Интеграции на основе API для создания чатов и отправки сообщений в указанные чаты · Входящие вебхуки для упрощенной отправки сообщений без API · Получение информации в реальном времени при помощи исходящих вебхуков · [и многое другое](https://www.pachca.com/blog#integration)

**Полезные форматы для работы с AI:**  
[llms.txt](http://crm.pachca.com/dev/llms.txt) — краткая версия всей документации в markdown  
[llms-full.txt](http://crm.pachca.com/dev/llms-full.txt) — полный markdown-файл с оглавлением  
Также вы можете получить markdown-версию любой страницы, добавив .md к её адресу или используя кнопку «Скопировать как .md» в правом верхнем углу.

## Боты

Боты в Пачке являются основным способом создания автоматизаций. С помощью ботов вы можете использовать входящие и исходящие вебхуки, а также использовать API.

О том, как создать бота, добавить его в чаты и получить access\_token, вы можете прочитать в статье  
[https://www.pachca.com/articles/webhook](https://www.pachca.com/articles/webhook)

## Входящий Webhook

Входящий вебхук позволяет вам от имени бота отправлять сообщения в чаты, в которых бот состоит. При этом вам не требуется использовать API, а гибкость работы с принимаемыми данными вы можете настроить с помощью шаблонизаторов Liquid и Mustache. Это удобно, если вы используете бота только для получения каких-то простых внешних событий и сами указываете, в какие чаты бот добавлен (возможно, всего в один).

Входящий вебхук не дает возможности отправить личное сообщение или в указанный чат. Сообщение будет отправлено во все групповые чаты, где состоит бот. Чтобы отправить личное сообщение или указать конкретный чат - воспользуйтесь API методом [Новое сообщение](/messages/new).

Подробнее о работе с шаблонизаторами вы можете прочитать в статье  
[https://www.pachca.com/articles/kak-pravilno-zapolnit-shablon-webhook](https://www.pachca.com/articles/kak-pravilno-zapolnit-shablon-webhook)

## Исходящий Webhook

Исходящий вебхук позволяет вам получать уведомления о различных событиях на указанный вами URL.

Доступны следующие типы событий:  
\- Новые сообщения  
\- Редактирование и удаление сообщений  
\- Добавление и удаление реакций  
\- Нажатие кнопок  
\- Изменение состава участников чатов  
\- Изменение состава участников пространства

Вы можете как получать события о всех новых сообщениях, так и только тех, которые начинаются с указанных команд.

Подробнее об исходящих вебхуках вы можете прочитать по [ссылке](/getting-started/webhooks)

## API

Каждый созданный бот имеет свой уникальный токен для работы с API. Если вам нужно создавать чаты, управлять составом участников чатов, отправлять сообщения в указанные чаты и создавать интерактивное взаимодействие пользователя с ботом - вам необходимо использовать API.

Всю документацию по доступным методам и правилам работы с API вы можете найти в меню слева

## Администрирование

Вы можете автоматизировать управление составом участников пространства и наполнением их профилей. Каждый сотрудник в компании с ролью «Администратор» и «Владелец» имеет свой уникальный токен, который позволяет ему использовать уникальные методы API, недоступные ботам.

Список уникальных методов API:  
\- [Новый сотрудник](/users/new)  
\- [Редактирование сотрудника](/users/update)  
\- [Удаление сотрудника](/users/delete)  
\- [Новый тег](/group_tags/new)  
\- [Редактирование тега](/group_tags/update)  
\- [Удаление тега](/group_tags/delete)  
\- [Удаление сообщения](/messages/delete)

Получить access\_token для работы с API вы можете в интерфейсе продукта, в разделе «Автоматизации» → «API» (данный раздел доступен только пользователям с ролью «Администратор» и «Владелец»)

## Аналитика

На тарифе «Корпорация» владелец пространства может запросить экспорт через API, тем самым автоматизировать выгрузку сообщений и построение аналитики (или регулярное создание личных бекапов сообщений пространства).

Дополнительно, на любом тарифе можно получить сообщения доступных чатов через метод [Список сообщений чата](/messages/list).

Документация по работе с экспортом сообщений доступа по [ссылке](/common/export)

## Unfurl

Дополнительным исходящим вебхуком является возможность отслеживать отправленные пользователями ссылки и дополнять их своими данными, полученными из других систем.

Подробнее о разворачивании ссылок вы можете прочитать в статье  
[https://www.pachca.com/articles/unfurling-ssylok-v-pachce](https://www.pachca.com/articles/unfurling-ssylok-v-pachce)

Документация по работе с методом разворачивания ссылок доступа по [ссылке](/messages/link_previews)

---

# Chats

## archive

<a id="archive"></a>

# Архивация чата

Метод для отправки чата в архив.

Для отправки чата в архив вам необходимо знать `id` и указать его в `URL` запроса.

### архивация чата

put /chats/{id}/archive архивация чата

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор чата передается в URL (например, /chats/334/archive)

При безошибочном выполнении запроса тело ответа отсутствует

---

## get

<a id="get"></a>

# Информация о чате

Метод для получения информации о чате.

Для получения чата вам необходимо знать её `id` и указать его в `URL` запроса.

### получение информации о чате

get /chats/{id} получение информации о чате

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Чат |
| id | integer | Идентификатор чата |
| name | string | Название |
| owner_id | integer | Идентификатор пользователя, создавшего чат |
| created_at | string | Дата и время создания чата (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| member_ids | array of integers | Массив идентификаторов пользователей, участников |
| group_tag_ids | array of integers | Массив идентификаторов тегов, участников |
| channel | boolean | Тип: беседа (false) или канал (true) |
| personal | boolean | Личный (true) или групповой (false) чат |
| public | boolean | Доступ: закрытый (false) или открытый (true) |
| last_message_at | string | Дата и время создания последнего сообщения в чате (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| meet_room_url | string | Ссылка на Видеочат |
| not_found | Не удалось найти |

Идентификатор чата передается в URL (например, /chats/334)

```code-snippet__inner
{
  "data": {
    "id": 334,
    "name": "🤿 aqua",
    "created_at": "2021-08-28T15:56:53.000Z",
    "owner_id": 185,
    "member_ids": [
      185,
      186,
      187
    ],
    "group_tag_ids": [],
    "channel": true,
    "personal": false,
    "public": false,
    "last_message_at": "2021-08-28T15:58:13.000Z",
    "meet_room_url": "https://meet.pachca.com/aqua-94bb21b5"
  }
}
```

---

## list

<a id="list"></a>

# Список чатов

Метод для получения списка чатов по заданным параметрам.

### получение списка чатов

get /chats получение списка чатов

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| sort[{field}] | string | Составной параметр сортировки сущностей выборки. Варианты значений: по умолчанию desc (по убыванию) или asc (по возрастанию).На данный момент сортировка доступна по полям ({field}) id (идентификатор чата) и last_message_at (дата и время создания последнего сообщения). |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 25, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| availability | string | Параметр, который отвечает за доступность и выборку чатов для пользователя. Варианты значений: по умолчанию is_member (чаты, где пользователь является участником) или public (все открытые чаты компании, вне зависимости от участия в них пользователя). |
| last_message_at_after | string | Фильтрация по времени создания последнего сообщения. Будут возвращены те чаты, время последнего созданного сообщения в которых не раньше чем указанное (в формате YYYY-MM-DDThh:mm:ss.sssZ). |
| last_message_at_before | string | Фильтрация по времени создания последнего сообщения. Будут возвращены те чаты, время последнего созданного сообщения в которых не позже чем указанное (в формате YYYY-MM-DDThh:mm:ss.sssZ). |
| personal | boolean | Фильтрация по личным (если указано как true) и групповым (если указано как false) чатам. Если параметр не указан, то возвращаются любые чаты. |
| data | array of objects | Массив списка найденных чатов |
| id | integer | Идентификатор чата |
| name | string | Название |
| owner_id | integer | Идентификатор пользователя, создавшего чат |
| created_at | string | Дата и время создания чата (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| member_ids | array of integers | Массив идентификаторов пользователей, участников |
| group_tag_ids | array of integers | Массив идентификаторов тегов, участников |
| channel | boolean | Тип: беседа (false) или канал (true) |
| personal | boolean | Личный (true) или групповой (false) чат |
| public | boolean | Доступ: закрытый (false) или открытый (true) |
| last_message_at | string | Дата и время создания последнего сообщения в чате (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| meet_room_url | string | Ссылка на Видеочат |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Параметр не соответствует правилам (пояснения вы получите в поле message) |
| not_found | Не удалось найти |
| invalid | Параметр имеет неверный формат (идентификатор параметра вы получите в поле payload) |

Тело запроса отсутствует, параметры передаются в URL (например, /chats?per=2&sort\[id\]=desc)

```code-snippet__inner
{
  "data":
    [
      {
        "id": 334,
        "name": "🤿 aqua",
        "created_at": "2021-08-28T15:56:53.000Z",
        "owner_id": 185,
        "member_ids": [
            185,
            186,
            187
        ],
        "group_tag_ids": [],
        "channel": true,
        "personal": false,
        "public": false,
        "last_message_at": "2021-08-28T15:58:13.000Z",
        "meet_room_url": "https://meet.pachca.com/aqua-94bb21b5"
      },
      {
        "id": 333,
        "name": "development",
        "created_at": "2021-08-28T15:54:22.000Z",
        "owner_id": 185,
        "member_ids": [
            185
        ],
        "group_tag_ids": [
            22,
            24
        ],
        "channel": false,
        "personal": false,
        "public": true,
        "last_message_at": "2021-08-28T15:56:12.000Z",
        "meet_room_url": "https://meet.pachca.com/development-43sz53n8"
      }
    ]
}
```

---

## new

<a id="new"></a>

# Новый чат

Метод для создания нового чата.  
Для создания личной переписки 1 на 1 с пользователем воспользуйтесь методом [Новое сообщение](/messages/new).

При создании чата вы автоматически становитесь участником.

### создание нового чата

post /chats создание нового чата

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| chat | object* | Собранный объект параметров создаваемого чата |
| name | string* | Название |
| member_ids | array of integers | Массив идентификаторов пользователей, которые станут участниками |
| group_tag_ids | array of integers | Массив идентификаторов тегов, которые станут участниками |
| channel | boolean | Тип: беседа (по умолчанию, false) или канал (true) |
| public | boolean | Доступ: закрытый (по умолчанию, false) или открытый (true) |
| data | object | Созданный чат |
| id | integer | Идентификатор созданного чата |
| name | string | Название |
| owner_id | integer | Идентификатор пользователя, создавшего чат |
| created_at | string | Дата и время создания чата (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| member_ids | array of integers | Массив идентификаторов пользователей, участников |
| group_tag_ids | array of integers | Массив идентификаторов тегов, участников |
| channel | boolean | Тип: беседа (false) или канал (true) |
| personal | boolean | Личный (true) или групповой (false) чат |
| public | boolean | Доступ: закрытый (false) или открытый (true) |
| last_message_at | string | Дата и время создания последнего сообщения в чате (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| meet_room_url | string | Ссылка на Видеочат |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| not_found | Не удалось найти |
| invalid | Поле имеет неверный формат (идентификатор поля вы получите в поле payload) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
    "chat": {
        "name": "🤿 aqua",
        "member_ids": [186,187],
        "channel": true,
        "public": false
    }
}
```

```code-snippet__inner
{
    "data": {
        "id": 334,
        "name": "🤿 aqua",
        "created_at": "2021-08-28T15:56:53.000Z",
        "owner_id": 185,
        "member_ids": [
            185,
            186,
            187
        ],
        "group_tag_ids": [],
        "channel": true,
        "personal": false,
        "public": false,
        "last_message_at": "2021-08-28T15:56:53.000Z",
        "meet_room_url": "https://meet.pachca.com/aqua-94bb21b5"
    }
}
```

---

## unarchive

<a id="unarchive"></a>

# Разархивация чата

Метод для возвращения чата из архива.

Для разархивации чата вам необходимо знать её `id` и указать его в `URL` запроса.

### разархивация чата

put /chats/{id}/unarchive разархивация чата

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор чата передается в URL (например, /chats/334/unarchive)

При безошибочном выполнении запроса тело ответа отсутствует

---

## update

<a id="update"></a>

# Обновление чата

Метод для обновления параметров чата.

Для обновления чата вам необходимо знать `id` и указать его в `URL` запроса. Все обновляемые параметры чата указываются в теле запроса.

### обновление чата по указанному идентификатору

put /chats/{id} обновление чата по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| chat | object* | Собранный объект параметров обновляемого чата |
| name | string** | Название |
| public | boolean** | Доступ: закрытый (по умолчанию, false) или открытый (true) |
| data | object | Обновленный чат |
| id | integer | Идентификатор чата |
| name | string | Название |
| owner_id | integer | Идентификатор пользователя, создавшего чат |
| created_at | string | Дата и время создания чата (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| member_ids | array of integers | Массив идентификаторов пользователей, участников |
| group_tag_ids | array of integers | Массив идентификаторов тегов, участников |
| channel | boolean | Тип: беседа (false) или канал (true) |
| personal | boolean | Личный (true) или групповой (false) чат |
| public | boolean | Доступ: закрытый (false) или открытый (true) |
| last_message_at | string | Дата и время создания последнего сообщения в чате (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| not_found | Не удалось найти |
| invalid | Поле имеет неверный формат (идентификатор поля вы получите в поле payload) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор обновляемого чата передается в URL (например, /chats/334)  
Остальные параметры указываются в теле запроса
```code-snippet__inner
{
  "chat": {
    "name": "Бассейн",
    "public": true
  }
}
```

```code-snippet__inner
{
    "data": {
        "id": 334,
        "name": "Бассейн",
        "created_at": "2021-08-28T15:56:53.000Z",
        "owner_id": 185,
        "member_ids": [
            185,
            186,
            187
        ],
        "group_tag_ids": [],
        "channel": true,
        "personal": false,
        "public": true,
        "last_message_at": "2021-08-28T15:58:23.000Z"
    }
}
```

---

# Messages

## delete

<a id="delete"></a>

# Удаление сообщения

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для удаления сообщения.

Удаление сообщения доступно отправителю, админам и редакторам в чате. В личных сообщениях оба пользователя являются редакторами. Ограничений по давности отправки сообщения нет.

Для удаления сообщения вам необходимо знать его `id` и указать его в `URL` запроса.

### удаление сообщения по указанному идентификатору

delete /messages/{id} удаление сообщения по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор удаляемого сообщения передается в URL (например, /messages/2486651)

При безошибочном выполнении запроса тело ответа отсутствует

---

## delete

<a id="delete"></a>

# Открепление сообщения

Метод для открепления сообщения из чата.

Для открепления сообщения вам необходимо знать `id` сообщения и указать его в `URL` запроса.

### открепление сообщения

delete /messages/{id}/pin открепление сообщения

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор сообщения, которое открепляется из чата, передается в URL (например, /messages/7231942/pin).

При безошибочном выполнении запроса тело ответа отсутствует

---

## get

<a id="get"></a>

# Информация о сообщении

Метод для получения информации о сообщении.

Для получения сообщения вам необходимо знать его `id` и указать его в `URL` запроса.

### получение информации о сообщении

get /messages/{id} получение информации о сообщении

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Информация о сообщении |
| id | integer | Идентификатор сообщения |
| entity_type | string | Тип сущности, к которой относится сообщение: беседа/канал (discussion), тред (thread) или пользователь (user) |
| entity_id | integer | Идентификатор сущности, к которой относится сообщение (беседы/канала, треда или пользователя) |
| chat_id | integer | Идентификатор чата, в котором находится сообщение |
| content | string | Текст сообщения |
| user_id | integer | Идентификатор пользователя, создавшего сообщение |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| url | string | Прямая ссылка на сообщение |
| files | array of objects | Прикреплённые файлы |
| id | integer | Идентификатор файла |
| key | string | Путь к файлу |
| name | string | Название файла |
| file_type | string | Тип файла: файл (file), изображение (image) |
| url | string | Прямая временная ссылка на скачивание файла |
| width | integer или null | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer или null | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects | Массив строк, каждая из которых представлена массивом кнопок. |
| text | string | Текст, отображаемый на кнопке пользователю |
| url | string | Ссылка, которая будет открыта по нажатию кнопки |
| data | string | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| thread | object или null | Тред сообщения. Возвращается как null, если у сообщения нет комментариев. |
| id | integer | Идентификатор треда |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| forwarding | object или null | Информация о пересылаемом сообщении. Возвращается как null, если это сообщение не является пересылаемым с сохранением автора. |
| original_message_id | integer | Идентификатор оригинального сообщения |
| original_chat_id | integer | Идентификатор чата, в котором находится оригинальное сообщение |
| author_id | integer | Идентификатор пользователя, создавшего оригинальное сообщение |
| original_created_at | string | Дата и время создания оригинального сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| original_thread_id | integer или null | Идентификатор треда, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_message_id | integer или null | Идентификатор сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_parent_chat_id | integer или null | Идентификатор чата сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| parent_message_id | integer или null | Идентификатор сообщения, к которому написан ответ. Возвращается как null, если сообщение не является ответом. |
| display_avatar_url | string или null | Ссылка на аватарку отправителя сообщения. Возвращается как null, если для этого сообщения не была указана специальная аватарка. |
| display_name | string или null | Полное имя отправителя сообщения. Возвращается как null, если для этого сообщения не было указано специальное имя. |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения передается в URL (например, /messages/194275)

```code-snippet__inner
{
  "data": {
    "id": 194275,
    "entity_type": "discussion",
    "entity_id": 198,
    "chat_id": 198,
    "content": "Вчера мы продали 756 футболок (что на 10% больше, чем в прошлое воскресенье)",
    "user_id": 12,
    "created_at": "2020-06-08T09:32:57.000Z",
    "url": "https://app.pachca.com/chats/198?message=194275",
    "files": [
      {
        "id": 3560,
        "key": "attaches/files/12/21zu7934-02e1-44d9-8df2-0f970c259796/congrat.png",
        "name": "congrat.png",
        "file_type": "image",
        "url": "https://pachca-prod-uploads.s3.storage.selcloud.ru/attaches/files/12/21zu7934-02e1-44d9-8df2-0f970c259796/congrat.png?response-cache-control=max-age%3D3600%3B&response-content-disposition=attachment&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=142155_staply%2F20231107%2Fru-1a%2Fs3%2Faws4_request&X-Amz-Date=20231107T160412Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=98765asgfadsfdsaDSd4sdfg35asdf67sadf8",
        "width": 1920,
        "height": 1080
      }
    ],
    "buttons": [],
    "thread": {
      "id": 29873,
      "chat_id": 1949863
    },
    "forwarding": null,
    "parent_message_id": 194274,
    "display_avatar_url": null,
    "display_name": null
  }
}
```

---

## link_previews

<a id="link_previews"></a>

# Unfurl (разворачивание ссылок)

Данный метод доступен для работы только с access\_token unfurl бота  
Подробнее о том, как получить такой токен и о том, как получать события об отправке ссылок в сообщении, вы можете прочитать в статье [Unfurling ссылок в Пачке](https://www.pachca.com/articles/unfurling-ssylok-v-pachce)

Метод для создания предпросмотров ссылок в сообщениях.

Для создания предпросмотров ссылок вам необходимо знать `id` сообщения и указать его в `URL` запроса.

Изображения вы можете предоставить как публичной ссылкой (параметром `image_url`), так и с помощью прямой загрузки файла на наш сервер (параметром `image`) через метод [Загрузка файлов](common/files). Если вы указали оба параметра сразу, то `image` является более приоритетным.

Если среди присланных URL-ключей будет выявлена ошибка (такого URL нет в сообщении или боту не прописан в настройках домен указанного URL), то запрос не будет выполнен (не будет создано ни одного предпросмотра).

На данный момент поддерживается отображение только первого созданного предпросмотра ссылки к сообщению  
Все присланные вами link\_previews будут сохранены и появятся в сообщениях в ближайших обновлениях  
По мере обновления клиентских платформ мы будем изменять этот текст

### создание предпросмотров ссылок в сообщении

post /messages/{id}/link\_previews создание предпросмотров ссылок в сообщении

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| link_previews | object* | JSON карта препросмотров ссылок, где каждый ключ - URL, который был получен в исходящем вебхуке о новом сообщении. |
| URL | object* | URL ключ, за которым находится собранный объект предпросмотра ссылки |
| title | string* | Заголовок |
| description | string* | Описание |
| image_url | string | Публичная ссылка на изображение (если вы хотите загрузить файл изображения в Пачку, то используйте параметр image) |
| image | object | Изображение |
| key | string* | Путь к изображению, полученный в результате загрузки файла (каждое изображение в каждом предпросмотре ссылки должно иметь свой уникальный key, не допускается использование одного и того же key в разных предпросмотрах) |
| name | string* | Название изображения (рекомендуется писать вместе с расширением) |
| size | integer* | Размер изображения в байтах |
| ... | ... | ... |
| При безошибочном выполнении запроса тело ответа отсутствует |
| - | Бот не имеет доступа к работе с unfurl методом |
| - | Домен указанного URL не указан в настройках бота |
| - | Ошибка в формировании JSON карты предпросмотров ссылок |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
  "link_previews": {
    "https://example.com/4176": {
      "title": "Статья: Отправка файлов",
      "description": "Пример отправки файлов на удаленный сервер",
      "image": {
        "key": "attaches/files/93746/e354fd79-9jh6-f2hd-fj83-709dae24c763/${filename}",
        "name": "files-to-server.jpg",
        "size": "695604"
      }
    },
    "https://tasks.example.com/l/38765": {
      "title": "Задача: Верстка сайта",
      "description": "Необходимо сверстать одностраничный сайт по макету",
      "image_url": "https://website.com/img/landing.png"
    }
  }
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

## list

<a id="list"></a>

# Список сообщений чата

Метод для получения списка сообщений бесед, каналов, тредов и личных сообщений.

Для получения сообщений вам необходимо знать `chat_id` требуемой беседы, канала, треда или диалога, и указать его в `URL` запроса. Сообщения будут возвращены в порядке убывания даты отправки (то есть, сначала будут идти последние сообщения чата). Для получения более ранних сообщений чата доступны параметры `per` и `page`.

### получение списка сообщений чата

get /messages получение списка сообщений чата

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| chat_id | integer* | Идентификатор чата (беседа, канал, диалог или чат треда) |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 25, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| sort[{field}] | string | Составной параметр сортировки сущностей выборки. Варианты значений: по умолчанию desc (по убыванию) или asc (по возрастанию).На данный момент сортировка доступна только по полю ({field}) id (идентификатор сообщения). |
| data | array of objects | Массив списка сообщений |
| id | integer | Идентификатор сообщения |
| entity_type | string | Тип сущности, к которой относится сообщение: беседа/канал (discussion), тред (thread) или пользователь (user) |
| entity_id | integer | Идентификатор сущности, к которой относится сообщение (беседы/канала, треда или пользователя) |
| chat_id | integer | Идентификатор чата, в котором находится сообщение |
| content | string | Текст сообщения |
| user_id | integer | Идентификатор пользователя, создавшего сообщение |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| url | string | Прямая ссылка на сообщение |
| files | array of objects | Прикреплённые файлы |
| id | integer | Идентификатор файла |
| key | string | Путь к файлу |
| name | string | Название файла |
| file_type | string | Тип файла: файл (file), изображение (image) |
| url | string | Прямая временная ссылка на скачивание файла |
| width | integer или null | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer или null | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects | Массив строк, каждая из которых представлена массивом кнопок. |
| text | string | Текст, отображаемый на кнопке пользователю |
| url | string | Ссылка, которая будет открыта по нажатию кнопки |
| data | string | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| thread | object или null | Тред сообщения. Возвращается как null, если у сообщения нет комментариев. |
| id | integer | Идентификатор треда |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| forwarding | object или null | Информация о пересылаемом сообщении. Возвращается как null, если это сообщение не является пересылаемым с сохранением автора. |
| original_message_id | integer | Идентификатор оригинального сообщения |
| original_chat_id | integer | Идентификатор чата, в котором находится оригинальное сообщение |
| author_id | integer | Идентификатор пользователя, создавшего оригинальное сообщение |
| original_created_at | string | Дата и время создания оригинального сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| original_thread_id | integer или null | Идентификатор треда, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_message_id | integer или null | Идентификатор сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_parent_chat_id | integer или null | Идентификатор чата сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| parent_message_id | integer или null | Идентификатор сообщения, к которому написан ответ. Возвращается как null, если сообщение не является ответом. |
| display_avatar_url | string или null | Ссылка на аватарку отправителя сообщения. Возвращается как null, если для этого сообщения не была указана специальная аватарка. |
| display_name | string или null | Полное имя отправителя сообщения. Возвращается как null, если для этого сообщения не было указано специальное имя. |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Тело запроса отсутствует, параметры передаются в URL (например, /messages?chat\_id=198&per=3)

```code-snippet__inner
{
  "data": [
    {
      "id": 1194277,
      "entity_type": "discussion",
      "entity_id": 198,
      "chat_id": 198,
      "content": "Это сообщение тоже попадёт в экспорт",
      "user_id": 12,
      "created_at": "2023-09-18T13:43:32.000Z",
      "url": "https://app.pachca.com/chats/198?message=1194277",
      "files": [],
      "buttons": [],
      "thread": {
        "id": 2633,
        "chat_id": 44997
      },
      "forwarding": null,
      "parent_message_id": null,
      "display_avatar_url": null,
      "display_name": null
    },
    {
      "id": 1194276,
      "entity_type": "discussion",
      "entity_id": 198,
      "chat_id": 198,
      "content": "**Andrew** добавил **Export bot** в беседу",
      "user_id": 12,
      "created_at": "2023-09-18T13:43:27.000Z",
      "url": "https://app.pachca.com/chats/198?message=1194276",
      "files": [],
      "buttons": [],
      "thread": null,
      "forwarding": null,
      "parent_message_id": null,
      "display_avatar_url": null,
      "display_name": null
    },
    {
      "id": 1194275,
      "entity_type": "discussion",
      "entity_id": 198,
      "chat_id": 198,
      "content": "**Andrew** создал беседу",
      "user_id": 12,
      "created_at": "2023-09-18T13:43:19.000Z",
      "url": "https://app.pachca.com/chats/198?message=1194275",
      "files": [],
      "buttons": [],
      "thread": null,
      "forwarding": null,
      "parent_message_id": null,
      "display_avatar_url": null,
      "display_name": null
    }
  ]
}
```

---

## new

<a id="new"></a>

# Новое сообщение

Метод для отправки сообщения в беседу или канал, личного сообщения пользователю или комментария в тред.

При использовании `entity_type: "discussion"` (или просто без указания `entity_type`) допускается отправка любого `chat_id` в поле `entity_id`. То есть, сообщение можно отправить зная только идентификатор чата. При этом, вы имеете возможность отправить сообщение в тред по его идентификатору или личное сообщение по идентификатору пользователя.

Для отправки личного сообщения пользователю создавать чат не требуется. Достаточно указать `entity_type: "user"` и идентификатор пользователя. Чат будет создан автоматически, если между вами ещё не было переписки. Между двумя пользователями может быть только один личный чат.

### создание нового сообщения

post /messages создание нового сообщения

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| message | object | Собранный объект параметров создаваемого сообщения |
| entity_type | string | Тип сущности: беседа или канал (по умолчанию, discussion), пользователь (user), тред (thread). Для создания треда к сообщению воспользуйтесь методом новый тред. |
| entity_id | integer* | Идентификатор сущности |
| content | string* | Текст сообщения |
| files | array of objects | Прикрепляемые файлы |
| key | string* | Путь к файлу, полученный в результате загрузки файла (каждый файл в каждом сообщении должен иметь свой уникальный key, не допускается использование одного и того же key в разных сообщениях) |
| name | string* | Название файла, которое вы хотите отображать пользователю (рекомендуется писать вместе с расширением) |
| file_type | string* | Тип файла: файл (file), изображение (image) |
| size | integer* | Размер файла в байтах, отображаемый пользователю |
| width | integer | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects | Массив строк, каждая из которых представлена массивом кнопок. Подробнее о том, как формировать строки кнопок и какие есть ограничения вы можете прочитать в статье. |
| text | string* | Текст, отображаемый на кнопке пользователю |
| url | string** | Ссылка, которая будет открыта по нажатию кнопки |
| data | string** | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| parent_message_id | integer | Идентификатор сообщения. Указывается в случае, если вы отправляете ответ на другое сообщение. |
| display_avatar_url | string | Ссылка на специальную аватарку отправителя для этого сообщения. Использование этого поля возможно только с access_token бота. |
| display_name | string | Полное специальное имя отправителя для этого сообщения. Использование этого поля возможно только с access_token бота. |
| skip_invite_mentions | boolean | [Этот параметр работает только при отправке сообщения в тред] Добавление в тред упоминаемых пользователей (при значении true упоминаемые пользователи не будут добавлены в тред). По умолчанию упоминаемые в сообщении пользователи добавляются в тред. |
| link_preview | boolean | Отображение предпросмотра ссылки у сообщения (при значении true у сообщения будет отображаться предпросмотр первой найденной в тексте сообщения ссылки). По умолчанию предпросмотр ссылки не отображается. |
| data | object | Созданное сообщение |
| id | integer | Идентификатор созданного сообщения |
| entity_type | string | Тип сущности, к которой относится сообщение: беседа/канал (discussion), тред (thread) или пользователь (user) |
| entity_id | integer | Идентификатор сущности, к которой относится сообщение (беседы/канала, треда или пользователя) |
| chat_id | integer | Идентификатор чата, в котором находится сообщение |
| content | string | Текст сообщения |
| user_id | integer | Идентификатор пользователя, создавшего сообщение |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| url | string | Прямая ссылка на сообщение |
| files | array of objects | Прикреплённые файлы |
| id | integer | Идентификатор файла |
| key | string | Путь к файлу |
| name | string | Название файла |
| file_type | string | Тип файла: файл (file), изображение (image) |
| url | string | Прямая временная ссылка на скачивание файла |
| width | integer или null | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer или null | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects | Массив строк, каждая из которых представлена массивом кнопок. |
| text | string | Текст, отображаемый на кнопке пользователю |
| url | string | Ссылка, которая будет открыта по нажатию кнопки |
| data | string | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| thread | object или null | Тред сообщения. Возвращается как null, если у сообщения нет комментариев. |
| id | integer | Идентификатор треда (используется для отправки новых комментариев) |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| forwarding | object или null | Информация о пересылаемом сообщении. Возвращается как null, если это сообщение не является пересылаемым с сохранением автора. |
| original_message_id | integer | Идентификатор оригинального сообщения |
| original_chat_id | integer | Идентификатор чата, в котором находится оригинальное сообщение |
| author_id | integer | Идентификатор пользователя, создавшего оригинальное сообщение |
| original_created_at | string | Дата и время создания оригинального сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| original_thread_id | integer или null | Идентификатор треда, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_message_id | integer или null | Идентификатор сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_parent_chat_id | integer или null | Идентификатор чата сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| parent_message_id | integer или null | Идентификатор сообщения, к которому написан ответ. Возвращается как null, если сообщение не является ответом. |
| display_avatar_url | string или null | Ссылка на аватарку отправителя сообщения. Возвращается как null, если для этого сообщения не была указана специальная аватарка. |
| display_name | string или null | Полное имя отправителя сообщения. Возвращается как null, если для этого сообщения не было указано специальное имя. |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
  "message": {
    "entity_type": "discussion",
    "entity_id": 198,
    "content": "Вчера мы продали 756 футболок (что на 10% больше, чем в прошлое воскресенье)"
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 194275,
    "entity_type": "discussion",
    "entity_id": 198,
    "chat_id": 198,
    "content": "Вчера мы продали 756 футболок (что на 10% больше, чем в прошлое воскресенье)",
    "user_id": 12,
    "created_at": "2020-06-08T09:32:57.000Z",
    "url": "https://app.pachca.com/chats/198?message=194275",
    "files": [],
    "buttons": [],
    "thread": null,
    "forwarding": null,
    "parent_message_id": null,
    "display_avatar_url": null,
    "display_name": null
  }
}
```

---

## new

<a id="new"></a>

# Закрепление сообщения

Метод для закрепления сообщения в чате.

Для закрепления сообщения вам необходимо знать `id` сообщения и указать его в `URL` запроса.

### закрепление сообщения

post /messages/{id}/pin закрепление сообщения

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |
| already_exists | Сообщение уже закреплено в чате |

Идентификатор сообщения, которое закрепляется в чате, передается в URL (например, /messages/7231942/pin).

При безошибочном выполнении запроса тело ответа отсутствует

---

## update

<a id="update"></a>

# Редактирование сообщения

Метод для редактирования сообщения или комментария.

Для редактирования сообщения вам необходимо знать его `id` и указать его в `URL` запроса. Все редактируемые параметры сообщения указываются в теле запроса.

### редактирование сообщения по указанному идентификатору

put /messages/{id} редактирование сообщения по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| message | object* | Собранный объект параметров редактируемого сообщения |
| content | string** | Текст сообщения |
| files | array of objects** | Прикрепляемые файлы |
| key | string* | Путь к файлу, полученный в результате загрузки файла (каждый файл в каждом сообщении должен иметь свой уникальный key, не допускается использование одного и того же key в разных сообщениях) |
| name | string* | Название файла, которое вы хотите отображать пользователю (рекомендуется писать вместе с расширением) |
| file_type | string* | Тип файла: файл (file), изображение (image) |
| size | integer* | Размер файла в байтах, отображаемый пользователю |
| width | integer | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects** | Массив строк, каждая из которых представлена массивом кнопок. Подробнее о том, как формировать строки кнопок и какие есть ограничения вы можете прочитать в статье. Для удаления кнопок у сообщения пришлите пустой массив. |
| text | string* | Текст, отображаемый на кнопке пользователю |
| url | string** | Ссылка, которая будет открыта по нажатию кнопки |
| data | string** | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| display_avatar_url | string** | Ссылка на специальную аватарку отправителя для этого сообщения. Использование этого поля возможно только с access_token бота. |
| display_name | string** | Полное специальное имя отправителя для этого сообщения. Использование этого поля возможно только с access_token бота. |
| data | object | Созданное сообщение |
| id | integer | Идентификатор созданного сообщения |
| entity_type | string | Тип сущности, к которой относится сообщение: беседа/канал (discussion), тред (thread) или пользователь (user) |
| entity_id | integer | Идентификатор сущности, к которой относится сообщение (беседы/канала, треда или пользователя) |
| chat_id | integer | Идентификатор чата, в котором находится сообщение |
| content | string | Текст сообщения |
| user_id | integer | Идентификатор пользователя, создавшего сообщение |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| url | string | Прямая ссылка на сообщение |
| files | array of objects | Прикреплённые файлы |
| id | integer | Идентификатор файла |
| key | string | Путь к файлу |
| name | string | Название файла |
| file_type | string | Тип файла: файл (file), изображение (image) |
| url | string | Прямая временная ссылка на скачивание файла |
| width | integer или null | Ширина изображения в px (используется в случае, если file_type указан как image) |
| height | integer или null | Высота изображения в px (используется в случае, если file_type указан как image) |
| buttons | array of array of objects | Массив строк, каждая из которых представлена массивом кнопок. |
| text | string | Текст, отображаемый на кнопке пользователю |
| url | string | Ссылка, которая будет открыта по нажатию кнопки |
| data | string | Данные, которые будут отправлены в исходящем вебхуке по нажатию кнопки |
| thread | object или null | Тред сообщения. Возвращается как null, если у сообщения нет комментариев. |
| id | integer | Идентификатор треда |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| forwarding | object или null | Информация о пересылаемом сообщении. Возвращается как null, если это сообщение не является пересылаемым с сохранением автора. |
| original_message_id | integer | Идентификатор оригинального сообщения |
| original_chat_id | integer | Идентификатор чата, в котором находится оригинальное сообщение |
| author_id | integer | Идентификатор пользователя, создавшего оригинальное сообщение |
| original_created_at | string | Дата и время создания оригинального сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| original_thread_id | integer или null | Идентификатор треда, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_message_id | integer или null | Идентификатор сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| original_thread_parent_chat_id | integer или null | Идентификатор чата сообщения, к которому был создан тред, в котором находится оригинальное сообщение. Возвращается как null, если оригинальное сообщение не является комментарием в треде. |
| parent_message_id | integer или null | Идентификатор сообщения, к которому написан ответ. Возвращается как null, если сообщение не является ответом. |
| display_avatar_url | string или null | Ссылка на аватарку отправителя сообщения. Возвращается как null, если для этого сообщения не была указана специальная аватарка. |
| display_name | string или null | Полное имя отправителя сообщения. Возвращается как null, если для этого сообщения не было указано специальное имя. |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор редактируемого сообщения передается в URL (например, /messages/7231942)  
Остальные параметры указываются в теле запроса
```code-snippet__inner
{
  "message": {
    "content": "Вот попробуйте написать правильно это с первого раза: Будущий, Полощи, Прийти, Грейпфрут, Мозаика, Бюллетень, Дуршлаг, Винегрет.",
    "files": []
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 7231942,
    "entity_type": "discussion",
    "entity_id": 17452,
    "chat_id": 17452,
    "content": "Вот попробуйте написать правильно это с первого раза: Будущий, Полощи, Прийти, Грейпфрут, Мозаика, Бюллетень, Дуршлаг, Винегрет.",
    "user_id": 65,
    "created_at": "2022-06-08T09:32:57.000Z",
    "url": "https://app.pachca.com/chats/17452?message=7231942",
    "files": [],
    "buttons": [],
    "thread": null,
    "forwarding": null,
    "parent_message_id": null,
    "display_avatar_url": null,
    "display_name": null
  }
}
```

---

# Users

## delete

<a id="delete"></a>

# Удаление сотрудника

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для удаления сотрудника.

Для удаления сотрудника вам необходимо знать его `id` и указать его в `URL` запроса.

### удаление сотрудника по указанному идентификатору

delete /users/{id} удаление сотрудника по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор удаляемого сотрудника передается в URL (например, /users/12)

При безошибочном выполнении запроса тело ответа отсутствует

---

## get

<a id="get"></a>

# Информация о сотруднике

Метод для получения информации о сотруднике.

Для получения сотрудника вам необходимо знать его `id` и указать его в `URL` запроса.

### получение информации о сотруднике

get /users/{id} получение информации о сотруднике

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Информация о сотруднике |
| id | integer | Идентификатор пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Деактивация пользователя. При значении true пользователь является деактивированным. |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| not_found | Не удалось найти |

Тело запроса отсутствует, параметры передаются в URL (например, /users/12)

```code-snippet__inner
{
  "data": {
    "id": 12,
    "first_name": "Олег",
    "last_name": "Петров",
    "nickname": "",
    "email": "olegp@example.com",
    "phone_number": "",
    "department": "Продукт",
    "title": "CIO",
    "role": "admin",
    "suspended": false,
    "invite_status": "confirmed",
    "list_tags": [
      "Product",
      "Design"
    ],
    "custom_properties": [
      {
        "id": 1678,
        "name": "Город",
        "data_type": "string",
        "value": "Санкт-Петербург"
      }
    ],
    "user_status": null,
    "bot": false,
    "created_at": "2020-06-08T09:32:57.000Z",
    "last_activity_at": "2025-01-20T13:40:07.000Z",
    "time_zone": "Europe/Moscow",
    "image_url": null
  }
}
```

---

## list

<a id="list"></a>

# Список сотрудников

Метод для получения актуального списка сотрудников вашей компании.

### получение актуального списка всех сотрудников компании

get /users получение актуального списка всех сотрудников компании

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 50, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| query | string | Поисковая фраза для фильтрации результатов (поиск идет по полям first_name (имя), last_name (фамилия), email (электронная почта), phone_number (телефон) и nickname (никнейм)) |
| data | array of objects | Массив списка сотрудников |
| id | integer | Идентификатор пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Деактивация пользователя. При значении true пользователь является деактивированным. |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| Описания ошибок отсутствуют |

Тело запроса отсутствует, параметры передаются в URL (например, /users?per=50&page=2&query=example.com)

```code-snippet__inner
{
  "data": [
    {
      "id": 12,
      "first_name": "Олег",
      "last_name": "Петров",
      "nickname": "olegpetrov",
      "email": "olegp@example.com",
      "phone_number": "",
      "department": "Продукт",
      "title": "CIO",
      "role": "admin",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Product",
        "Design"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Санкт-Петербург"
        }
      ],
      "user_status": null,
      "bot": false,
      "created_at": "2020-06-08T09:10:11.000Z",
      "last_activity_at": "2025-01-20T13:40:07.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    },
    {
      "id": 13,
      "first_name": "Сергей",
      "last_name": "Кузнецов",
      "nickname": "skuz",
      "email": "sergkuzn@example.com",
      "phone_number": "",
      "department": "Разработка",
      "title": "iOS Developer",
      "role": "user",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Development",
        "Android"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Москва"
        }
      ],
      "user_status": {
        "emoji": "🎮",
        "title": "Очень занят",
        "expires_at": "2024-04-08T10:00:00.000Z"
      },
      "bot": false,
      "created_at": "2020-06-08T09:31:17.000Z",
      "last_activity_at": "2025-01-20T07:00:32.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    },
    {
      "id": 14,
      "first_name": "Дмитрий",
      "last_name": "Смирнов",
      "nickname": "dsmir",
      "email": "ds@example.com",
      "phone_number": "",
      "department": "Разработка",
      "title": "Android Developer",
      "role": "user",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Development",
        "Frontend"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Санкт-Петербург"
        }
      ],
      "user_status": {
        "emoji": "🚀",
        "title": "Лечу",
        "expires_at": null
      },
      "bot": false,
      "created_at": "2020-06-08T09:32:57.000Z",
      "last_activity_at": "2025-01-20T13:51:25.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    }
  ]
}
```

---

## new

<a id="new"></a>

# Новый сотрудник

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для создания нового сотрудника в вашей компании.

Вы можете заполнять дополнительные поля сотрудника, которые созданы в вашей компании. Получить актуальный список идентификаторов дополнительных полей сотрудника вы можете в методе [Список дополнительных полей](/common/fields).

### создание нового сотрудника

post /users создание нового сотрудника

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| user | object* | Собранный объект параметров создаваемого сотрудника |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string* | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Деактивация пользователя. При значении true пользователь является деактивированным. |
| list_tags | array of strings | Массив тегов, привязываемых к сотруднику |
| custom_properties | array of objects | Задаваемые дополнительные поля |
| id | integer | Идентификатор поля |
| value | string | Устанавливаемое значение |
| skip_email_notify | boolean | Пропуск этапа отправки приглашения сотруднику (при значении true сотруднику не будет отправлено письмо на электронную почту с приглашением создать аккаунт). Данный параметр полезен в случае предварительного создания аккаунтов сотрудникам перед их входом через SSO. |
| data | object | Созданный сотрудник |
| id | integer | Идентификатор созданного пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Деактивация пользователя. При значении true пользователь является деактивированным. |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
  "user": {
    "first_name": "Олег",
    "last_name": "Петров",
    "email": "olegp@example.com",
    "department": "Продукт",
    "list_tags": [
      "Product",
      "Design"
    ],
    "custom_properties": [
      {
        "id": 1678,
        "value": "Санкт-Петербург"
      }
    ]
  },
  "skip_email_notify": true
}
```

```code-snippet__inner
{
  "data": {
    "id": 12,
    "first_name": "Олег",
    "last_name": "Петров",
    "nickname": "",
    "email": "olegp@example.com",
    "phone_number": "",
    "department": "Продукт",
    "title": "",
    "role": "admin",
    "suspended": false,
    "invite_status": "confirmed",
    "list_tags": [
      "Product",
      "Design"
    ],
    "custom_properties": [
      {
        "id": 1678,
        "name": "Город",
        "data_type": "string",
        "value": "Санкт-Петербург"
      }
    ],
    "user_status": null,
    "bot": false,
    "created_at": "2023-06-08T09:31:17.000Z",
    "last_activity_at": null,
    "time_zone": "Europe/Moscow",
    "image_url": null
  }
}
```

---

## update

<a id="update"></a>

# Редактирование сотрудника

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для редактирования сотрудника.

Для редактирования сотрудника вам необходимо знать его `id` и указать его в `URL` запроса. Все редактируемые параметры сотрудника указываются в теле запроса. Получить актуальный список идентификаторов дополнительных полей сотрудника вы можете в методе [Список дополнительных полей](/common/fields).

### редактирование сотрудника по указанному идентификатору

put /users/{id} редактирование сотрудника по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| user | object* | Собранный объект параметров редактируемого сотрудника |
| first_name | string** | Имя |
| last_name | string** | Фамилия |
| nickname | string** | Имя пользователя |
| email | string** | Электронная почта |
| phone_number | string** | Телефон |
| department | string** | Департамент |
| title | string** | Должность |
| role | string** | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean** | Деактивация пользователя. При значении true пользователь является деактивированным. |
| list_tags | array of strings** | Массив тегов, привязываемых к сотруднику |
| custom_properties | array of objects** | Задаваемые дополнительные поля |
| id | integer | Идентификатор поля |
| value | string | Устанавливаемое значение |
| data | object | Обновленный сотрудник |
| id | integer | Идентификатор пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Приостановка доступа |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| licenses_limit | Превышен лимит активных сотрудников (пояснения вы получите в поле message) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор редактируемого сотрудника передается в URL (например, /users/12)  
Остальные параметры указываются в теле запроса
```code-snippet__inner
{
  "user": {
    "nickname": "olegpetrov",
    "role": "user",
    "list_tags": [
      "Product"
    ]
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 12,
    "first_name": "Олег",
    "last_name": "Петров",
    "nickname": "olegpetrov",
    "email": "olegp@example.com",
    "phone_number": "",
    "department": "Продукт",
    "title": "CIO",
    "role": "user",
    "suspended": false,
    "invite_status": "confirmed",
    "list_tags": [
      "Product"
    ],
    "custom_properties": [
      {
        "id": 1678,
        "name": "Город",
        "data_type": "string",
        "value": "Санкт-Петербург"
      }
    ],
    "user_status": null,
    "bot": false,
    "created_at": "2023-07-08T09:31:17.000Z",
    "last_activity_at": "2025-01-20T13:40:07.000Z",
    "time_zone": "Europe/Moscow",
    "image_url": null
  }
}
```

---

# Common

## export

<a id="export"></a>

# Экспорт сообщений Доступно только на тарифе «Корпорация»

Экспорт сообщений доступен только с access\_token владельца пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Экспорт сообщений — это архив c файлами в формате JSON, где собраны все сообщения из всех чатов, которые были созданы в вашем пространстве.

В экспорте вам будут доступны все сообщения из открытых, закрытых и архивных чатов, в том числе треды. У каждого сообщения будет указан автор, время отправки, текст, список реакций на это сообщение.

Так же, в экспорте есть личные переписки, но в ограниченном формате. В них указан автор сообщения, время отправки, но нет контента сообщений и тредов. Эти данные полезны для оценки вовлеченность сотрудников их активности или оценке нагрузки на каждого из членов команды.

На основе выгрузки можно замерять количество сообщений и реакций в общих чатах. Так можно рассчитать Engagment Rate и улучшать корп. культуру/коммуникацию среди сотрудников. Ещё можно подсчитывать количество активных чатов и смотреть, насколько много в компании ведется обсуждений.

## Запрос экспорта

При запросе экспорта можно настроить период, за который вы хотите получить данные, но не более 45 дней. И можете добавить ID-чатов, из которых вы хотите получить экспорт. Если вам нужны данные за период дольше 45 дней, то по завершении одной выгрузки, можно запросить следующую с новым диапазоном дат.

При запросе экспорта важно учитывать следующие ограничения:  
\- выгружаются все чаты, в том числе архивные и личные без контента сообщений  
\- не выгружаются треды в личных сообщениях  
\- не учитываются вложения  
\- не отражаются пересланные сообщения  
\- максимальный период одной выгрузки: 45 дней (при запросе с указанием конкретных чатов - 366 дней)  
\- максимальный количество запрашиваемых чатов (при указании): 50  
\- новый запрос на экспорта вы сможете сделать после завершения текущего

### запрос экспорта сообщений

post /chats/exports запрос экспорта сообщений

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| start_at | string* | Дата начала для экспорта (ISO-8601, UTC+0) в формате YYYY-MM-DD |
| end_at | string* | Дата окончания для экспорта (ISO-8601, UTC+0) в формате YYYY-MM-DD |
| webhook_url | string* | Адрес, на который будет отправлен вебхук по завершению экспорта |
| chat_ids | array of integers | Массив идентификаторов чатов. Указывается, если нужно получить сообщения только некоторых чатов. |
| При безошибочном выполнении запроса тело ответа отсутствует |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| invalid_date_range | Выбран слишком большой диапазон дат |
| invalid_webhook_url | Некорректный URL вебхука |
| rate_limit | Достигнут лимит запросов |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
    "start_at": "2025-03-20",
    "end_at": "2025-03-20",
    "webhook_url": "https://webhook.site/9227d3b8-6e82-4e64-bf5d-ad972ad270f2",
    "chat_ids": [1381521]
}
```

При безошибочном выполнении запроса тело ответа отсутствует

Экспорт выполняется асинхронно. На указанный `webhook_url` будет отправлен JSON с информацией о готовом экспорте.

### Пример JSON вебхука об успешном завершении экспорта

Пример JSON вебхука об успешном завершении экспорта

```code-snippet__inner
{
    "type": "export",
    "event": "ready",
    "export_id": 22322,
    "created_at": "2025-03-20T12:33:58Z"
}
```

## Скачивание готового архива

Получив JSON с информацией о готовом экспорте, вам необходимо взять значение поля `export_id` и выполнить запрос на скачивание архива сообщений, указав его в `URL` запроса.

### скачивание экспорта сообщений

get /chats/exports/{id} скачивание экспорта сообщений

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует. Вы получите .zip архив. |
| not_found | Не удалось найти |

Тело запроса отсутствует, параметры передаются в URL (например, /chats/exports/22322)

При безошибочном выполнении запроса тело ответа отсутствует. Вы получите .zip архив.

## Архив сообщений

Архив представляет собой папки, где каждая папка соответствует чату в вашем пространстве. Название папки состоит из имени чата и его ID, например: `Design_12925828` . Внутри папки будут JSON-файлы, которые соответствуют дате переписки. Каждый день — отдельный файл.

### Структура данных в JSON-файлах

Структура данных в JSON-файлах

| id | integer | Идентификатор сообщения |
| --- | --- | --- |
| created_at | string | Дата и время создания сообщения (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| content | string | Текст сообщения |
| reactions | array of objects | Массив списка реакций |
| user_id | integer | Идентификатор пользователя, который добавил реакцию |
| created_at | string | Дата и время добавления реакции (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| code | string | Emoji символ реакции |
| user | object | Информация об авторе сообщения |
| id | integer | Идентификатор пользователя |
| role | string | Тип: member (пользователь), bot (бот) |
| name | string | Имя |
| last_name | string | Фамилия |
| email | string | Электронная почта |
| tags | array of strings | Массив тегов, привязанных к пользователю |
| chat | object | Информация о чате, в котором было написано сообщение |
| id | integer | Идентификатор чата |
| name | string | Название чата |
| owner | object | Информация о владельце чата |
| id | integer | Идентификатор пользователя |
| role | string | Тип: member (пользователь), bot (бот) |
| name | string | Имя |
| last_name | string | Фамилия |
| email | string | Электронная почта |
| tags | array of strings | Массив тегов, привязанных к пользователю |
| tags | array of strings | Массив тегов, привязанных к чату |
| thread | object или null | Тред сообщения. Возвращается как null, если у сообщения нет комментариев. |
| message_id | integer | Идентификатор сообщения, под которым был начат тред |
| message_chat_id | string | Идентификатор чата, в котором был начат тред |

---

## fields

<a id="fields"></a>

# Список дополнительных полей На данный момент работа с дополнительными полями типа "Файл" недоступна.

Метод для получения актуального списка дополнительных полей участников и напоминаний в вашей компании.

По умолчанию в вашей компании все сущности имеют только базовые поля. Но администратор вашей компании может добавлять дополнительные поля, редактировать их и удалять. Если при создании сотрудников (или напоминаний) вы используете дополнительные поля, которые не являются актуальными (удалены или не существуют) - вы получите ошибку.

### получение списка актульных полей сущности

get /custom\_properties получение списка актульных полей сущности

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| entity_type | string* | Тип сущности: участник (User) или напоминание (Task). |
| data | array of objects | Массив полей |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| blank | Поле не может быть пустым |
| inclusion | Поле имеет непредусмотренное значение |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Тело запроса отсутствует, параметры передаются в URL  
(например, /custom\_properties?entity\_type=User)

```code-snippet__inner
{
  "data": [
    {
      "id": 1487,
      "name": "Адрес",
      "data_type": "string"
    },
    {
      "id": 1489,
      "name": "Номер доступа",
      "data_type": "number"
    },
    {
      "id": 1572,
      "name": "Дата рождения",
      "data_type": "date"
    }
  ]
}
```

---

## files

<a id="files"></a>

# Загрузка файлов

Для того, чтобы прикрепить файл к сообщению или к какой-то другой сущности в других методах API, вам необходимо сначала загрузить его на сервер, используя для этого уникальный набор параметров, а затем сформировать ссылку на загруженный файл.

## Получение подписи, ключа и других параметров Данный метод необходимо использовать для загрузки каждого файла.

Данный метод позволяет получить уникальный набор параметров для загрузки файла.

### получения подписи и ключа для загрузки файла

post /uploads получения подписи и ключа для загрузки файла

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| Content-Disposition | string | Используемый заголовок (в данном запросе - attachment) |
| acl | string | Уровень безопасности (в данном запросе - private) |
| policy | string | Уникальный policy для загрузки файла |
| x-amz-credential | string | x-amz-credential для загрузки файла |
| x-amz-algorithm | string | Используемый алгоритм (в данном запросе - AWS4-HMAC-SHA256) |
| x-amz-date | string | Уникальный x-amz-date для загрузки файла |
| x-amz-signature | string | Уникальная подпись для загрузки файла |
| key | string | Уникальный ключ для загрузки файла |
| direct_url | string | Адрес для загрузки файла |
| Описания ошибок отсутствуют |

Тело запроса отсутствует

```code-snippet__inner
{
    "Content-Disposition": "attachment",
    "acl": "private",
    "policy": "eyJloNBpcmF0aW9uIjoiMjAyPi0xMi0wOFQwNjo1NzozNFHusCJjb82kaXRpb25zIjpbeyJidWNrZXQiOiJwYWNoY2EtcHJhYC11cGxvYWRzOu0sWyJzdGFydHMtd3l4aCIsIiRrZXkiLCJhdHRhY8hlcy9maWxlcy1xODUyMSJdLHsiQ29udGVudC1EaXNwb3NpdGlvbiI6ImF0dGFjaG1lbnQifSx2ImFjbCI3InByaXZhdGUifSx7IngtYW16LWNyZWRlbnRpYWwi2iIxNDIxNTVfc3RhcGx4LzIwMjIxMTI0L4J1LTFhL5MzL1F2czRfcmVxdWVzdCJ9LHsieC1hbXotYWxnb3JpdGhtIjytQVdTNC1ITUFDLVNIQTI1NiJ7LHsieC1hbXotZGF0ZSI6IjIwMjIxMTI0VDA2NTczNFoifV22",
    "x-amz-credential": "286471_server/20211122/kz-6x/s3/aws4_request",
    "x-amz-algorithm": "AWS4-HMAC-SHA256",
    "x-amz-date": "20211122T065734Z",
    "x-amz-signature": "87e8f3ba4083c937c0e891d7a11tre932d8c33cg4bacf5380bf27624c1ok1475",
    "key": "attaches/files/93746/e354fd79-9jh6-f2hd-fj83-709dae24c763/${filename}",
    "direct_url": "https://api.pachca.com/api/v3/direct_upload"
}
```

После получения параметров для загрузки файла, вы можете переходить к загрузке.

## Загрузка файла Данный метод не требует авторизации

Получив все параметры, вам необходимо сделать `POST` запрос в формате `multipart/form-data` на адрес, который был указан в поле `direct_url` , отправив полученные параметры и сам файл.

### загрузка файла

post direct\_url (полученный в ответе на запрос /uploads) загрузка файла

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса |
| --- | --- | --- |
| Content-Disposition | string* | Параметр Content-Disposition, полученный в ответе на запрос /uploads |
| acl | string* | Параметр acl, полученный в ответе на запрос /uploads |
| policy | string* | Параметр policy, полученный в ответе на запрос /uploads |
| x-amz-credential | string* | Параметр x-amz-credential, полученный в ответе на запрос /uploads |
| x-amz-algorithm | string* | Параметр x-amz-algorithm, полученный в ответе на запрос /uploads |
| x-amz-date | string* | Параметр x-amz-date, полученный в ответе на запрос /uploads |
| x-amz-signature | string* | Параметр x-amz-signature, полученный в ответе на запрос /uploads |
| key | string* | Параметр key, полученный в ответе на запрос /uploads |
| file | file* | Файл для загрузки |
| При безошибочном выполнении запроса тело ответа отсутствует, код ответа 204 |
| При ошибке выполнения запроса вы получите в ответ xml, в котором будет расписана ошибка Error и в поле Message будут указаны подробности |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Пример запроса отсутствует  
Запрос необходимо отправлять в формате multipart/form-data

При безошибочном выполнении запроса тело ответа отсутствует

## Прикрение файла к сообщению или к другим сущностям (формирование ссылки)

После того, как вы успешно загрузили файл на сервер, вам необходимо сформировать правильный путь до файла, который вы будете использовать в методе [отправки сообщения](/messages/new) и других методах, где вам потребуется прикрепить файл.

Для этого замените фразу `${filename}` в `key` на название файла, который вы отравляли.

Например, ваш файл назывался `Логотип для сайта.png` ,  
а в поле `key` вы получили `attaches/files/93746/e354fd79-9jh6-f2hd-fj83-709dae24c763/${filename}` .

Тогда итоговый путь к файлу, который вы будете использовать для его прикрепления к сообщению и в других методах, получится `attaches/files/93746/e354fd79-9jh6-f2hd-fj83-709dae24c763/Логотип для сайта.png` .

---

# Profile

## delete

<a id="delete"></a>

# Удаление статуса

Метод для удаления своего статуса.

### удаление своего статуса

delete /profile/status удаление своего статуса

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ |
| --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |

Тело запроса отсутствует

При безошибочном выполнении запроса тело ответа отсутствует

---

## get

<a id="get"></a>

# Информация о профиле

Метод для получения информации о своем профиле.

### получение информации о профиле

get /profile получение информации о профиле

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Информация о пользователе |
| id | integer | Идентификатор пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Деактивация пользователя. При значении true пользователь является деактивированным. |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| Возможные коды ошибок отсутствуют |

Тело запроса отсутствует

```code-snippet__inner
{
  "data": {
    "id": 12,
    "first_name": "Олег",
    "last_name": "Петров",
    "nickname": "",
    "email": "olegp@example.com",
    "phone_number": "",
    "department": "Продукт",
    "title": "CIO",
    "role": "admin",
    "suspended": false,
    "invite_status": "confirmed",
    "list_tags": [
      "Product",
      "Design"
    ],
    "custom_properties": [
      {
        "id": 1678,
        "name": "Город",
        "data_type": "string",
        "value": "Санкт-Петербург"
      }
    ],
    "user_status": null,
    "bot": false,
    "created_at": "2020-06-08T09:32:57.000Z",
    "last_activity_at": "2025-01-20T13:40:07.000Z",
    "time_zone": "Europe/Moscow",
    "image_url": null
  }
}
```

---

## get

<a id="get"></a>

# Текущий статус

Метод для получения информации о своем статусе.

### получение информации о своем статусе

get /profile/status получение информации о своем статусе

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ |
| --- | --- |
| Параметры запроса отсутствуют |
| data | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |

Тело запроса отсутствует

```code-snippet__inner
{
  "data": {
    "emoji": "🎮",
    "title": "Очень занят",
    "expires_at": "2024-04-08T10:00:00.000Z"
  }
}
```

---

## put

<a id="put"></a>

# Новый статус

Метод для установки себе нового статуса.

### новый статус

put /profile/status новый статус

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| status | object* | Собранный объект параметров нового статуса |
| emoji | string* | Emoji символ статуса |
| title | string* | Текст статуса |
| expires_at | string | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| data | object | Установленный статус |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| wrong_emoji | Emoji статуса не может содержать значения отличные от Emoji символа |

```code-snippet__inner
{
  "status": {
    "emoji": "🎮",
    "title": "Очень занят",
    "expires_at": "2024-04-08T10:00:00.000Z"
  }
}
```

```code-snippet__inner
{
  "data": {
    "emoji": "🎮",
    "title": "Очень занят",
    "expires_at": "2024-04-08T10:00:00.000Z"
  }
}
```

---

# Threads

## get

<a id="get"></a>

# Информация о треде

Метод для получения информации о треде.

Для получения треда вам необходимо знать его `id` и указать его в `URL` запроса.

### информация о треде

get /threads/{id} информация о треде

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Тред |
| id | integer | Идентификатор треда (используется для отправки новых комментариев в тред) |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| message_id | integer | Идентификатор сообщения, к которому создан тред |
| message_chat_id | integer | Идентификатор чата сообщения |
| updated_at | string | Дата и время обновления треда (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения передается в URL (например, /thread/265142)

```code-snippet__inner
{
    "data": {
        "id": 265142,
        "chat_id": 2637266155,
        "message_id": 154332686,
        "message_chat_id": 2637266154,
        "updated_at": "2023-02-01T19:20:47.204Z"
    }
}
```

---

## new

<a id="new"></a>

# Новый тред

Метод для создания нового треда к сообщению.

Если у сообщения уже был создан тред, то в ответе на запрос вернётся информация об уже созданном раннее треде.

### создание нового треда

post /messages/{id}/thread создание нового треда

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Созданный тред |
| id | integer | Идентификатор созданного треда (используется для отправки новых комментариев в тред) |
| chat_id | integer | Идентификатор чата треда (используется для отправки новых комментариев в тред и получения списка комментариев) |
| message_id | integer | Идентификатор сообщения, к которому был создан тред |
| message_chat_id | integer | Идентификатор чата сообщения |
| updated_at | string | Дата и время обновления треда (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения, к которому создается тред, передается в URL (например, /messages/154332686/thread)

```code-snippet__inner
{
    "data": {
        "id": 265142,
        "chat_id": 2637266155,
        "message_id": 154332686,
        "message_chat_id": 2637266154,
        "updated_at": "2023-02-01T19:20:47.204Z"
    }
}
```

---

# Reactions

## delete

<a id="delete"></a>

# Удаление реакции

Метод для удаления реакции на сообщение.

Для удаления реакции вам необходимо знать `id` сообщения и указать его в `URL` запроса. Реакции на сообщения хранятся в виде символов Emoji.

Удалять можно только те реакции, которые были поставлены авторизованным пользователем.

### удаление реакции

delete /messages/{id}/reactions удаление реакции

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| code | string* | Emoji символ реакции |
| При безошибочном выполнении запроса тело ответа отсутствует |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения, у которого удаляется реакция, передается в URL (например, /messages/7231942/reactions). Код реакции указывается в теле запроса.
```code-snippet__inner
{
  "code": "👍"
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

## list

<a id="list"></a>

# Список реакций

Метод для получения актуального списка реакций на сообщение.

### получение актуального списка реакций

get /messages/{id}/reactions получение актуального списка реакций

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 50, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| data | array of objects | Массив списка реакций |
| user_id | integer | Идентификатор пользователя, который добавил реакцию |
| created_at | string | Дата и время добавления реакции (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| code | string | Emoji символ реакции |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения, список реакций на которое необходимо получить, передается в URL (например, /messages/7231942/reactions). Количество возвращаемых сущностей и страница выборки указываются в теле запроса.
```code-snippet__inner
{
  "per": 7,
  "page": 2
}
```

```code-snippet__inner
{
    "data": [
        {
            "user_id": 76243,
            "created_at": "2023-09-11T14:59:35.000Z",
            "code": "👍"
        },
        {
            "user_id": 10764,
            "created_at": "2023-09-11T15:00:31.000Z",
            "code": "👍"
        },
        {
            "user_id": 27494,
            "created_at": "2023-09-11T15:01:27.000Z",
            "code": "👍"
        },
        {
            "user_id": 27494,
            "created_at": "2023-09-11T15:01:47.000Z",
            "code": "🔥"
        },
        {
            "user_id": 11887,
            "created_at": "2023-09-11T15:12:49.000Z",
            "code": "👍"
        },
        {
            "user_id": 11887,
            "created_at": "2023-09-11T15:13:46.000Z",
            "code": "⭐"
        },
        {
            "user_id": 11887,
            "created_at": "2023-09-11T15:13:47.000Z",
            "code": "🔥"
        }
    ]
}
```

---

## new

<a id="new"></a>

# Добавление реакции

Метод для добавления реакции на сообщение.

Для добавления реакции вам необходимо знать `id` сообщения и указать его в `URL` запроса. Реакции на сообщения отправляются в виде символов Emoji. Если пользователь уже ставил реакцию - повторно она установлена не будет. Для удаления реакции надо воспользоваться методом [Удаление реакции](/reactions/delete).

Лимиты реакций:  
\- Каждый пользователь может установить не более 20 уникальных реакций  
\- Сообщение может иметь не более 30 уникальных реакций  
\- Сообщение может иметь не более 1000 реакций

### добавление реакции

post /messages/{id}/reactions добавление реакции

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| code | string* | Emoji символ реакции |
| При безошибочном выполнении запроса тело ответа отсутствует |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
| user_limit | Превышен лимит количества реакций, которые может добавить пользователь (20 уникальных реакций) |
| unique_limit | Превышен лимит количества уникальных реакций, которые можно добавить на сообщение (30 уникальных реакций) |
| general_limit | Превышен лимит количества реакций, которые можно добавить на сообщение (1000 реакций) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения, на которое добавляется реакция, передается в URL (например, /messages/7231942/reactions). Код реакции указывается в теле запроса.
```code-snippet__inner
{
  "code": "👍"
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

# Tasks

## new

<a id="new"></a>

# Новое напоминание На текущий момент данный метод поддерживает только создание напоминаний без привязки к каким-либо сущностям

Метод для создания нового напоминания.

При создании напоминания обязательным условием является указания типа напоминания: звонок, встреча, простое напоминание, событие или письмо. При этом не требуется дополнительное описание - вы просто создадите напоминание с соответствующим текстом. Если вы укажите описание напоминания - то именно оно и станет текстом напоминания.

У напоминания должны быть ответственные, если их не указывать - ответственным назначаетесь вы.

Ответственным для напоминания без привязки к каким-либо сущностям может стать любой сотрудник компании. Актуальный состав сотрудников компании вы можете получить в методе [список сотрудников](/common/users).

### создание нового напоминания

post /tasks создание нового напоминания

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| task | object* | Собранный объект параметров создаваемого напоминания |
| kind | string* | Тип: call (позвонить контакту), meeting (встреча), reminder (простое напоминание), event (событие), email (написать письмо) |
| content | string | Описание (по умолчанию - название типа) |
| due_at | string | Срок выполнения напоминания (ISO-8601) в формате YYYY-MM-DDThh:mm:ss.sssTZD. Если указано время 23:59:59.000, то напоминание будет создано на весь день (без указания времени). |
| priority | integer | Приоритет: 1 (по умолчанию), 2 (важно) или 3 (очень важно). |
| performer_ids | array of integers | Массив идентификаторов пользователей, привязываемых к напоминанию как «ответственные» (по умолчанию ответственным назначаетесь вы) |
| custom_properties | array of objects | Задаваемые дополнительные поля |
| id | integer | Идентификатор поля |
| value | string | Устанавливаемое значение |
| data | object | Созданное напоминание |
| id | integer | Идентификатор созданного напоминания |
| kind | string | Тип |
| content | string | Описание |
| due_at | string | Срок выполнения напоминания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| priority | integer | Приоритет |
| user_id | integer | Идентификатор пользователя-создателя напоминания |
| status | string | Статус напоминания (активная - undone) |
| created_at | string | Дата и время создания напоминания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| performer_ids | array of integers | Массив идентификаторов пользователей, привязанных к напоминанию как «ответственные» |
| custom_properties | array of objects | Дополнительные поля напоминания |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| blank | Поле не может быть пустым |
| too_long | Поле не может содержать более 65535 символов |
| inclusion | Поле имеет непредусмотренное значение |
| invalid | Поле имеет неверное значение (например, указаны недопустимые ответственные) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
  "task": {
    "kind": "reminder",
    "content": "Забрать со склада 21 заказ",
    "due_at": "2020-06-05T12:00:00.000+0300",
    "priority": 2,
    "custom_properties": [
      {
        "id": 78,
        "value": "Синий склад"
      }
    ]
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 22283,
    "kind": "reminder",
    "content": "Забрать со склада 21 заказ",
    "due_at": "2020-06-05T09:00:00.000Z",
    "priority": 2,
    "user_id": 12,
    "status": "undone",
    "created_at": "2020-06-04T10:37:57.000Z",
    "performer_ids": [
      12
    ],
    "custom_properties": [
      {
        "id": 78,
        "name": "Место",
        "data_type": "string",
        "value": "Синий склад"
      }
    ]
  }
}
```

---

# Members

## delete

<a id="delete"></a>

# Исключение тега

Метод для исключения тега из состава участников беседы или канала.

Для исключения тега вам необходимо знать его `id` и указать его в `URL` запроса.

### исключение тега из состава участников

delete /chats/{id}/group\_tags/{id} исключение тега из состава участников

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификаторы беседы/канала и исключаемого тега передаются в URL (например, /chats/553/group\_tags/12)

При безошибочном выполнении запроса тело ответа отсутствует

---

## delete

<a id="delete"></a>

# Исключение пользователя

Метод для исключения пользователя из состава участников беседы или канала.  
Если пользователь является владельцем чата, то исключить его нельзя. Он может только самостоятельно выйти из чата, воспользовавшись методом [Выход из беседы или канала](/members/users/leave).

### исключение пользователя из состава участников

delete /chats/{id}/members/{id} исключение пользователя из состава участников

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификаторы беседы/канала и исключаемого пользователя передаются в URL (например, /chats/553/members/186)

При безошибочном выполнении запроса тело ответа отсутствует

---

## leave

<a id="leave"></a>

# Выход из беседы или канала

Метод для самостоятельного выхода из беседы или канала.

### выход из беседы или канала

delete /chats/{id}/leave выход из беседы или канала

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |
| personal_chat | Нельзя покинуть персональный чат |

Идентификаторы беседы/канала передается в URL (например, /chats/553/leave)

При безошибочном выполнении запроса тело ответа отсутствует

---

## list

<a id="list"></a>

# Список участников чата

Метод для получения актуального списка участников чата.

### получение актуального списка участников чата

get /chats/{id}/members получение актуального списка участников чата

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| role | string | Роль в чате: all (по умолчанию, любая), owner (создатель), admin (админ), editor (редактор), member (участник/подписчик) |
| limit | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 50, максимум 50) |
| cursor | string | Курсор для пагинации (из meta.paginate.next_page) |
| meta | object | Вспомогательная информация |
| paginate | object | Информация о пагинации |
| next_page | string | Курсор пагинации следующей страницы |
| data | array of objects | Массив списка участников |
| id | integer | Идентификатор созданного пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Приостановка доступа |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| not_found | Не удалось найти |
| exclusion | Поле имеет недопустимое значение |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор чата, список участников которого необходимо получить, и другие параметры передаются в URL (например, /chats/334/members?role=admin&limit=1)

```code-snippet__inner
{
  "meta": {
    "paginate": {
      "next_page": "eyJpZCI6MiwiZGlyIjoiYXNjIn0"
    }
  }
  "data": [
    {
      "id": 12,
      "first_name": "Олег",
      "last_name": "Петров",
      "nickname": "olegpetrov",
      "email": "olegp@example.com",
      "phone_number": "",
      "department": "Продукт",
      "title": "CIO",
      "role": "admin",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Product",
        "Design"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Санкт-Петербург"
        }
      ],
      "user_status": null,
      "bot": false,
      "created_at": "2020-06-08T09:10:11.000Z",
      "last_activity_at": "2025-01-20T13:40:07.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    }
  ]
}
```

---

## new

<a id="new"></a>

# Добавление тегов

Метод для добавления тегов в состав участников беседы или канала.

### добавление тегов в состав участников

post /chats/{id}/group\_tags добавление тегов в состав участников

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| group_tag_ids | array of integers* | Массив идентификаторов тегов, которые станут участниками |
| При безошибочном выполнении запроса тело ответа отсутствует |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| not_found | Не удалось найти |
| invalid | Поле имеет неверный формат (идентификатор поля вы получите в поле payload) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор беседы/канала передаётся в URL (например, /chats/553/group\_tags)  
Массив идентификаторов тегов, которые станут участниками, передается в теле запроса
```code-snippet__inner
{
    "group_tag_ids": [86,18]
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

## new

<a id="new"></a>

# Добавление пользователей

Метод для добавления пользователей в состав участников беседы или канала.

### добавление пользователей в состав участников

post /chats/{id}/members добавление пользователей в состав участников

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| member_ids | array of integers* | Массив идентификаторов пользователей, которые станут участниками |
| silent | boolean | Не создавать в чате системное сообщение о добавлении участника |
| При безошибочном выполнении запроса тело ответа отсутствует |
| blank | Обязательное поле (не может быть пустым) |
| too_long | Слишком длинное значение (пояснения вы получите в поле message) |
| invalid | Поле не соответствует правилам (пояснения вы получите в поле message) |
| not_found | Не удалось найти |
| invalid | Поле имеет неверный формат (идентификатор поля вы получите в поле payload) |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор беседы/канала передаётся в URL (например, /chats/553/members)  
Массив идентификаторов пользователей, которые станут участниками, передается в теле запроса
```code-snippet__inner
{
    "member_ids": [186,187]
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

## update

<a id="update"></a>

# Редактирование роли

Метод для редактирования роли пользователя или бота в беседе или канале.

Для редактирования роли в беседе или канале вам необходимо знать `id` чата и пользователя (или бота) и указать их в `URL` запроса. Все редактируемые параметры роли указываются в теле запроса.

Владельцу чата роль изменить нельзя. Он всегда имеет права Админа в чате.

### редактирование роли в беседе или канале

put /chats/{id}/members/{id} редактирование роли в беседе или канале

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| role | string* | Назначаемая роль: admin (админ), editor (редактор, доступно только для каналов), member (участник или подписчик) |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификаторы беседы/канала и пользователя (или бота) передаются в URL (например, /chats/553/members/186)  
Остальные параметры указываются в теле запроса
```code-snippet__inner
{
  "role": "admin"
}
```

При безошибочном выполнении запроса тело ответа отсутствует

---

# Group_tags

## delete

<a id="delete"></a>

# Удаление тега

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для удаления тега.

Для удаления тега вам необходимо знать его `id` и указать его в `URL` запроса.

### удаление тега по указанному идентификатору

delete /group\_tags/{id} удаление тега по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| При безошибочном выполнении запроса тело ответа отсутствует |
| not_found | Не удалось найти |

Идентификатор удаляемого тега передается в URL (например, /group\_tags/12)

При безошибочном выполнении запроса тело ответа отсутствует

---

## get

<a id="get"></a>

# Информация о теге

Метод для получения информации о теге. Названия тегов являются уникальными в компании.

Для получения тега вам необходимо знать его `id` и указать его в `URL` запроса.

### получение информации о теге

get /group\_tags/{id} получение информации о теге

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| Параметры запроса отсутствуют |
| data | object | Тег |
| id | integer | Идентификатор тега |
| name | string | Название тега |
| users_count | integer | Количество сотрудников, которые имеют этот тег |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения передается в URL (например, /group\_tags/9111)

```code-snippet__inner
{
  "data": {
    "id": 9111,
    "name": "Design",
    "users_count": 6
  }
}
```

---

## list

<a id="list"></a>

# Список тегов сотрудников

Метод для получения актуального списка тегов сотрудников. Названия тегов являются уникальными в компании.

### получение актуального списка тегов сотрудников

get /group\_tags получение актуального списка тегов сотрудников

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 50, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| data | array of objects | Массив списка тегов |
| id | integer | Идентификатор тега |
| name | string | Название тега |
| users_count | integer | Количество сотрудников, которые имеют этот тег |
| exclusion | Поле имеет недопустимое значение |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Тело запроса отсутствует, параметры передаются в URL (например, /group\_tags?per=10&page=2)

```code-snippet__inner
{
  "data": [
    {
      "id": 9111,
      "name": "Design",
      "users_count": 6
    },
    {
      "id": 9113,
      "name": "iOS",
      "users_count": 4
    },
    {
      "id": 9114,
      "name": "Android",
      "users_count": 36
    },
    {
      "id": 9115,
      "name": "Backend",
      "users_count": 15
    },
    {
      "id": 9510,
      "name": "Frontend",
      "users_count": 5
    }
  ]
}
```

---

## new

<a id="new"></a>

# Новый тег

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для создания нового тега.

### создание нового тега

post /group\_tags создание нового тега

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| group_tag | object* | Собранный объект параметров создаваемого тега |
| name | string* | Название тега |
| data | object | Созданный тег |
| id | integer | Идентификатор созданного тега |
| name | string | Название тега |
| users_count | integer | Количество сотрудников, которые имеют этот тег |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| taken | Название тега "Тег" для этого поля уже существует |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

```code-snippet__inner
{
  "group_tag": {
    "name": "Название тега"
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 1,
    "name": "Название тега",
    "users_count": 0
  }
}
```

---

## update

<a id="update"></a>

# Редактирование тега

Данный метод доступен для работы только с access\_token администратора пространства  
Подробнее о том, как получить такой токен, вы можете прочитать в разделе [Запросы и ответы](/getting-started/requests-and-responses)  
Бот пока не может работать с подобными методами и взаимодействует с API на уровне обычного участника пространства

Метод для редактирования тега.

Для редактирования тега вам необходимо знать его `id` и указать его в `URL` запроса. Все редактируемые параметры тега указываются в теле запроса.

### редактирование тега по указанному идентификатору

put /group\_tags/{id} редактирование тега по указанному идентификатору

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| group_tag | object* | Собранный объект параметров тега |
| name | string* | Название тега |
| data | object | Обновлённый тег |
| id | integer | Идентификатор тега |
| name | string | Название тега |
| users_count | integer | Количество сотрудников, которые имеют этот тег |
| blank | Поле не может быть пустым |
| exclusion | Поле имеет недопустимое значение |
| taken | Название тега "Тег" для этого поля уже существует |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор обновляемого тега передается в URL (например, /group\_tags/2345)  
Остальные параметры указываются в теле запроса
```code-snippet__inner
{
  "group_tag": {
    "name": "Новое название тега"
  }
}
```

```code-snippet__inner
{
  "data": {
    "id": 1,
    "name": "Новое название тега",
    "users_count": 0
  }
}
```

---

## users

<a id="users"></a>

# Список сотрудников тега

Метод для получения актуального списка сотрудников тега.

### получение актуального списка сотрудников тега

get /group\_tags/{id}/users получение актуального списка сотрудников тега

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 25, максимум 50) |
| page | integer | Страница выборки (по умолчанию 1) |
| data | array of objects | Массив списка сотрудников |
| id | integer | Идентификатор созданного пользователя |
| first_name | string | Имя |
| last_name | string | Фамилия |
| nickname | string | Имя пользователя |
| email | string | Электронная почта |
| phone_number | string | Телефон |
| department | string | Департамент |
| title | string | Должность |
| role | string | Уровень доступа: admin (администратор), user (сотрудник), multi_guest (мульти-гость) |
| suspended | boolean | Приостановка доступа |
| invite_status | string | Статус пришлашения: confirmed (принято), sent (отправлено) |
| list_tags | array of strings | Массив тегов, привязанных к сотруднику |
| custom_properties | array of objects | Дополнительные поля сотрудника |
| id | integer | Идентификатор поля |
| name | string | Название поля |
| data_type | string | Тип поля (string, number, date или link) |
| value | string | Значение |
| user_status | object или null | Статус. Возвращается как null, если статус не установлен. |
| emoji | string | Emoji символ статуса |
| title | string | Текст статуса |
| expires_at | string или null | Срок жизни статуса (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ. Возвращается как null, если срок не установлен. |
| bot | boolean | Тип: пользователь (false) или бот (true) |
| created_at | string | Дата создания (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| last_activity_at | string | Дата последней активности пользователя (ISO-8601, UTC+0) в формате YYYY-MM-DDThh:mm:ss.sssZ |
| time_zone | string | Часовой пояс пользователя |
| image_url | string или null | Ссылка на скачивание аватарки пользователя |
| exclusion | Поле имеет недопустимое значение |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор тега, список сотрудников которого необходимо получить, и другие параметры передаются в URL (например, /group\_tags/877650/users?per=3&page=2)

```code-snippet__inner
{
  "data": [
    {
      "id": 12,
      "first_name": "Олег",
      "last_name": "Петров",
      "nickname": "olegpetrov",
      "email": "olegp@example.com",
      "phone_number": "",
      "department": "Продукт",
      "title": "CIO",
      "role": "admin",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Product",
        "Design"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Санкт-Петербург"
        }
      ],
      "user_status": null,
      "bot": false,
      "created_at": "2020-06-08T09:10:11.000Z",
      "last_activity_at": "2025-01-20T13:40:07.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    },
    {
      "id": 13,
      "first_name": "Сергей",
      "last_name": "Кузнецов",
      "nickname": "skuz",
      "email": "sergkuzn@example.com",
      "phone_number": "",
      "department": "Разработка",
      "title": "iOS Developer",
      "role": "user",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Development",
        "Android"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Москва"
        }
      ],
      "user_status": {
        "emoji": "🎮",
        "title": "Очень занят",
        "expires_at": "2024-04-08T10:00:00.000Z"
      },
      "bot": false,
      "created_at": "2020-06-08T09:31:17.000Z",
      "last_activity_at": "2025-01-20T07:00:32.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    },
    {
      "id": 14,
      "first_name": "Дмитрий",
      "last_name": "Смирнов",
      "nickname": "dsmir",
      "email": "ds@example.com",
      "phone_number": "",
      "department": "Разработка",
      "title": "Android Developer",
      "role": "user",
      "suspended": false,
      "invite_status": "confirmed",
      "list_tags": [
        "Development",
        "Frontend"
      ],
      "custom_properties": [
        {
          "id": 1678,
          "name": "Город",
          "data_type": "string",
          "value": "Санкт-Петербург"
        }
      ],
      "user_status": {
        "emoji": "🚀",
        "title": "Лечу",
        "expires_at": null
      },
      "bot": false,
      "created_at": "2020-06-08T09:32:57.000Z",
      "last_activity_at": "2025-01-20T13:51:25.000Z",
      "time_zone": "Europe/Moscow",
      "image_url": null
    }
  ]
}
```

---

# Read_members

## list

<a id="list"></a>

# Список прочитавших сообщение

Метод для получения актуального списка пользователей, прочитавших сообщение.

### получение списка прочитавших сообщение

get /messages/{id}/read\_member\_ids получение списка прочитавших сообщение

Параметры Пример запроса Пример ответа

#### Запрос

| Запрос | Ответ | Возможные ошибки запроса (errors code) |
| --- | --- | --- |
| per | integer | Количество возвращаемых сущностей за один запрос (по умолчанию 300, максимум 300) |
| page | integer | Страница выборки (по умолчанию 1) |
| data | array of integers | Массив идентификаторов пользователей |
| exclusion | Поле имеет недопустимое значение |
| not_found | Не удалось найти |
|  |
| * обязательно** обязательно наличие хотя бы одного из параметров |

Идентификатор сообщения, список реакций на которое необходимо получить, передается в URL (например, /messages/7231942/read\_member\_ids). Количество возвращаемых сущностей и страница выборки указываются в теле запроса.
```code-snippet__inner
{
  "per": 5,
  "page": 2
}
```

```code-snippet__inner
{
    "data": [
      12,
      13,
      14,
      15,
      16
    ]
}
```

---



## End of Documentation

 Pachca. All rights reserved.
